{"id":"upkeep-rs-015","title":"Reduce excessive cloning in audit.rs BFS path_to","description":"In src/core/analyzers/audit.rs:174-222, BFS implementation clones PackageId (contains String) frequently in queue and visited set. Consider using references or indices to reduce allocations.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:27:38.873072-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.480428-06:00","closed_at":"2026-02-04T22:33:21.480428-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-05i","title":"Fix clippy approx_constant error in util.rs test","description":"In src/core/analyzers/util.rs:53, test uses 3.14 which triggers clippy::approx_constant deny error. Will cause CI failure. Fix: change json!(3.14) to json!(42.5).","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-04T22:37:04.770198-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.035544-06:00","closed_at":"2026-02-04T22:48:50.035544-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-0bn","title":"Add quality scorer unit tests","description":"Target: src/core/scorers/quality.rs\n\nAdd unit tests for scoring behavior:\n- dependency_freshness_score handles total=0 and correct ratio math.\n- security_score applies penalty constants for each severity.\n- unused_deps_score and unsafe_code_score penalties (0, 1..=5, and \u003e5 buckets).\n- clippy_score penalty math.\n- msrv_score for Valid/Missing/Invalid.\n- grade_for boundaries (A/B/C/D/F).\n- recommendations_for ordering by impact and correct messages when scores fall below thresholds.\n\nPrefer table-driven tests for score/grade/recommendation cases.","acceptance_criteria":"- Unit tests cover each scoring helper and grade boundaries.\n- Recommendation ordering and contents are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:53:01.244318-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:57:22.909203-06:00","closed_at":"2026-02-04T22:57:22.909203-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-0m3","title":"Rename lib module to core - fix non-idiomatic module naming","description":"The current src/lib/ module uses a reserved name that requires a lint suppression.\n\n**Issue:** src/main.rs has #![allow(special_module_name)] to suppress warning about 'mod lib;'\n\n**Why it matters:**\n- 'lib' is a reserved module name in Rust (lib.rs is for library crates)\n- This conflates binary/library distinction in Cargo\n- Requires lint suppression which is a code smell\n- Confuses contributors about project structure\n\n**Fix:**\n1. Rename src/lib/ directory to src/core/\n2. Update src/main.rs: change 'mod lib;' to 'mod core;'\n3. Remove the #![allow(special_module_name)] lint suppression\n4. Update any internal imports that reference the lib module\n\n**Files to modify:**\n- src/main.rs (lines 1, 4)\n- src/lib/ -\u003e src/core/ (directory rename)\n\n**Acceptance:** Code compiles without lint suppression, module follows Rust conventions","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:22:32.235905-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:50.92006-06:00","closed_at":"2026-02-04T07:28:50.92006-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-0m4","title":"Write README with installation and usage documentation","description":"Create comprehensive README.md:\n\n1. Project header:\n   - Name: cargo-upkeep\n   - Tagline: Unified Rust project maintenance CLI\n   - Badges: CI status, crates.io version, license\n   - Brief value proposition\n\n2. Installation section:\n   - From crates.io: cargo install cargo-upkeep\n   - Using binstall: cargo binstall cargo-upkeep\n   - From script: curl -fsSL .../install.sh | bash\n   - From source: cargo install --path .\n\n3. Usage examples for each command:\n   - cargo upkeep detect\n   - cargo upkeep deps\n   - cargo upkeep audit\n   - cargo upkeep quality\n   - cargo upkeep tree\n\n4. JSON output examples for each command\n\n5. Claude Code skills section:\n   - /upkeep-deps, /upkeep-audit, /upkeep-quality\n   - Link to skill documentation\n\n6. Comparison with existing tools (cargo-audit, cargo-outdated)\n\n7. Contributing section\n\n8. License and credits\n\nReference TS: README.md in upkeep repo\n\nAcceptance: README provides complete getting-started documentation","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:54.342363-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.881646-06:00","closed_at":"2026-02-05T13:28:51.881646-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-0qf","title":"BUG: Fix workspace detection for virtual workspaces","description":"Workspace detection logic fails for virtual workspaces with 1 member.\n\n**File:** src/cli/commands/detect.rs line 45\n\n**Current code:**\n```rust\nworkspace: metadata.workspace_members.len() \u003e 1,\n```\n\n**Bug:** A Cargo workspace is determined by presence of [workspace] section, not by member count. A workspace can have exactly 1 member and still be a workspace.\n\n**Failing scenarios:**\n1. Virtual workspace with single package (no root [package], only [workspace])\n2. Workspace with members = [\"crate-a\"] where other members were removed\n3. Single-package workspace planning to grow\n\n**Fix:**\n```rust\n// A workspace exists if:\n// 1. There's no root package (virtual workspace), OR\n// 2. There are multiple members\nlet is_workspace = root_package.is_none() || metadata.workspace_members.len() \u003e 1;\n```\n\nThis handles virtual workspaces correctly.\n\n**Acceptance:** Virtual workspace with 1 member correctly reports workspace: true","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:14:42.352836-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:16:37.716004-06:00","closed_at":"2026-02-04T09:16:37.716007-06:00"}
{"id":"upkeep-rs-0rt","title":"Remove assert!(true) placeholder smoke tests","description":"Clippy warns about assert!(true) tests that do nothing useful.\n\n**Files:**\n- src/main.rs (line 32)\n- src/core/mod.rs (line 11)\n- src/core/analyzers/mod.rs (line 7)\n- src/core/scorers/mod.rs (line 7)\n\n**Why it matters:** Generate compiler warnings and clutter test output.\n\n**Fix:**\nEither remove tests entirely or replace with empty test module:\n```rust\n#[cfg(test)]\nmod tests {\n    // No tests needed for this module yet\n}\n```\n\nOr just delete the test modules from these files until there's real code to test.\n\n**Acceptance:** No clippy warnings about assert!(true)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:10:26.075568-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:15:05.730466-06:00","closed_at":"2026-02-04T23:15:05.730466-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-0td","title":"Add explicit command name for unsafe subcommand","description":"The Unsafe variant works but command name could be made explicit for clarity.\n\n**File:** src/cli/mod.rs:50\n\n**Why it matters:** Minor clarity issue - being explicit about command naming helps maintainability and documents intent.\n\n**Fix:**\nAdd explicit name attribute:\n```rust\n/// Report unsafe code usage\n#[command(name = \"unsafe\")]\nUnsafe,\n```\n\n**Acceptance:** Code is explicit about unsafe command name","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:06.839747-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:47.193363-06:00","closed_at":"2026-02-04T21:21:47.193363-06:00","close_reason":"DONE: #[command(name = \"unsafe-code\", alias = \"unsafe\")] in cli/mod.rs"}
{"id":"upkeep-rs-0wc0","title":"Fix Windows zip path structure in release.yml","description":"In .github/workflows/release.yml:70-79, Windows zip may have wrong internal path structure. Verify archive structure matches what binstall expects.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-05T13:49:21.16414-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.720998-06:00","closed_at":"2026-02-05T14:04:28.720998-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-0wt","title":"Add crates.io publishing metadata to Cargo.toml","description":"Cargo.toml is missing required metadata for crates.io publishing.\n\n**Issue:** Missing description, repository, keywords, categories, readme fields\n\n**Why it matters:**\n- Cannot publish to crates.io without description\n- Users can't find the crate via search without keywords\n- No link back to repository for issues/contributions\n- cargo doc won't have proper crate documentation\n\n**Fix:**\nAdd to Cargo.toml [package] section:\n```toml\ndescription = \"Unified Rust project maintenance CLI\"\nrepository = \"https://github.com/llbbl/cargo-upkeep\"\nhomepage = \"https://github.com/llbbl/cargo-upkeep\"\ndocumentation = \"https://docs.rs/cargo-upkeep\"\nkeywords = [\"cargo\", \"dependencies\", \"security\", \"maintenance\", \"audit\"]\ncategories = [\"development-tools::cargo-plugins\", \"command-line-utilities\"]\nreadme = \"README.md\"\n```\n\n**Files to modify:**\n- Cargo.toml\n\n**Acceptance:** cargo publish --dry-run passes metadata validation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:22:57.696825-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.010412-06:00","closed_at":"2026-02-04T07:28:51.010412-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-111","title":"Implement quality scorer with weighted metrics","description":"Create src/lib/scorers/quality.rs following spec metric weights:\n\n1. Define weights per spec:\n   WEIGHT_DEPENDENCY_FRESHNESS: 0.20\n   WEIGHT_SECURITY: 0.25\n   WEIGHT_UNUSED_DEPS: 0.15\n   WEIGHT_UNSAFE_CODE: 0.15\n   WEIGHT_CLIPPY: 0.15\n   WEIGHT_MSRV: 0.10\n\n2. Implement individual metric scorers:\n   a) Dependency Freshness (20%): (up_to_date / total) * 100\n   b) Security (25%): 100 - (critical*25 + high*15 + moderate*5 + low*2)\n   c) Unused Dependencies (15%): MVP returns 100, later cargo-machete\n   d) Unsafe Code (15%): MVP returns 100, later cargo-geiger\n   e) Clippy (15%): max(0, 100 - warnings*2 - errors*10)\n   f) MSRV (10%): 100 if specified and valid, 50 if unspecified, 0 if invalid\n\n3. Calculate weighted total score\n4. Grade assignment: A (90-100), B (80-89), C (70-79), D (60-69), F (\u003c60)\n5. Generate prioritized recommendations\n\nReference TS: src/lib/scorers/quality.ts\n\nAcceptance: Quality scorer calculates accurate weighted scores","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:17.628944-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:19:35.76853-06:00","closed_at":"2026-02-04T14:19:35.76853-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-16u3","title":"Fix cargo-binstall metadata to match release assets","description":"Problem: Cargo.toml binstall metadata points to cargo-upkeep-{target} but release assets are .tar.gz/.zip archives.\n\nFix: Update [package.metadata.binstall] to point at archive names and add pkg-fmt/bin-dir as needed.\n\nAcceptance:\n- cargo-binstall can locate and install from release assets.\n- Metadata matches release artifact naming.","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-05T13:29:40.824691-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:29:40.824691-06:00","labels":["release"]}
{"id":"upkeep-rs-17v","title":"Remove unused dependencies from Cargo.toml","description":"Several dependencies are declared but not yet used.\n\n**Issue:** Cargo.toml declares dependencies not imported anywhere\n\n**Unused dependencies:**\n- cargo_metadata - not imported\n- crates-index - not imported  \n- reqwest - not imported\n- rustsec - not imported\n- semver - not imported\n- tempfile (dev) - not used in tests\n\n**Why it matters:**\n- Increases compile time unnecessarily\n- Adds to binary size\n- Confuses readers about what project actually uses\n- Security surface area without benefit\n\n**Fix - Option A (Remove until needed):**\nComment out or remove unused deps from Cargo.toml:\n```toml\n[dependencies]\nanyhow = \"1.0\"\nclap = { version = \"4.5\", features = [\"derive\"] }\n# cargo_metadata = \"0.18\"  # TODO: Add when implementing detect\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\nthiserror = \"1.0\"\ntokio = { version = \"1.0\", features = [\"rt-multi-thread\", \"macros\"] }\ntoml = \"0.8\"\ntracing = \"0.1\"\ntracing-subscriber = { version = \"0.3\", features = [\"env-filter\"] }\n```\n\n**Fix - Option B (Document as planned):**\nAdd comment explaining these are for planned features.\n\n**Files to modify:**\n- Cargo.toml\n\n**Acceptance:** No unused dependency warnings, faster compile times","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:33:08.742937-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.34089-06:00","closed_at":"2026-02-04T07:45:42.34089-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1a2","title":"Create basic CLI integration smoke test","description":"Zero tests exist in the project.\n\n**Issue:** No tests/ directory, no test modules, no test coverage\n\n**Why it matters:**\n- Cannot verify CLI works correctly\n- Refactoring is risky without tests\n- CI/CD has nothing to run\n- Contributors can't validate changes\n\n**Fix:**\nCreate tests/cli.rs:\n```rust\nuse assert_cmd::Command;\nuse predicates::prelude::*;\n\n#[test]\nfn cli_without_args_shows_help() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.arg(\"upkeep\")\n        .assert()\n        .failure()\n        .stderr(predicate::str::contains(\"Usage\"));\n}\n\n#[test]\nfn cli_version_flag_works() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"--version\"])\n        .assert()\n        .success()\n        .stdout(predicate::str::contains(env!(\"CARGO_PKG_VERSION\")));\n}\n\n#[test]\nfn cli_help_flag_works() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"--help\"])\n        .assert()\n        .success()\n        .stdout(predicate::str::contains(\"Unified Rust project maintenance\"));\n}\n```\n\n**Files to create:**\n- tests/cli.rs\n\n**Dependencies required:**\n- assert_cmd (dev-dependency)\n- predicates (dev-dependency)\n\n**Acceptance:** cargo test runs and passes basic smoke tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:29.511301-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.001736-06:00","closed_at":"2026-02-04T07:28:51.001736-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1cz","title":"Add unit test modules to source files","description":"Zero unit tests exist in source files.\n\n**Issue:** No #[cfg(test)] modules in any src/*.rs files\n\n**Why it matters:**\n- Cannot test internal functions in isolation\n- Integration tests alone don't cover edge cases\n- Rust convention is unit tests alongside code\n- Makes TDD workflow difficult\n\n**Fix:**\nAdd test modules to source files as functionality is implemented:\n\n```rust\n// In src/cli/mod.rs\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_log_level_parsing() {\n        // Test valid levels\n        assert!(EnvFilter::try_new(\"debug\").is_ok());\n        assert!(EnvFilter::try_new(\"info\").is_ok());\n        \n        // Test invalid levels\n        assert!(EnvFilter::try_new(\"invalid\").is_err());\n    }\n}\n```\n\n```rust\n// In src/core/output.rs (when implemented)\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_json_serialization() {\n        let output = DetectOutput { ... };\n        let json = serde_json::to_string(\u0026output).unwrap();\n        assert!(json.contains(\"edition\"));\n    }\n}\n```\n\n**Files to modify:**\n- src/cli/mod.rs\n- src/cli/commands/mod.rs\n- src/core/*.rs (as implemented)\n\n**Acceptance:** Each source file with logic has corresponding unit tests","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:33:23.880818-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.329878-06:00","closed_at":"2026-02-04T07:45:42.329878-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1eq","title":"Add tests for each CLI subcommand","description":"Tests only cover basic CLI smoke tests, missing subcommand coverage.\n\n**Issue:** tests/cli.rs - Only tests --help, --version, no subcommands\n\n**Missing test coverage:**\n- Tests for each subcommand (detect, audit, deps, quality, unused)\n- Tests for --verbose flag behavior\n- Tests for --log-level flag behavior\n- Tests for invalid inputs\n- Tests for --json flag (when implemented)\n\n**Why it matters:** Command handler is completely untested. When implementations are added, there's no safety net for regressions.\n\n**Fix:**\nAdd comprehensive subcommand tests:\n```rust\n#[test]\nfn cli_detect_command() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"detect\"])\n        .assert()\n        .success();  // or check specific output\n}\n\n#[test]\nfn cli_deps_command() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"deps\"])\n        .assert()\n        .success();\n}\n\n#[test]\nfn verbose_flag_accepted() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"--verbose\", \"detect\"])\n        .assert()\n        .success();\n}\n\n#[test]\nfn log_level_flag_accepted() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"--log-level\", \"debug\", \"detect\"])\n        .assert()\n        .success();\n}\n\n#[test]\nfn invalid_log_level_rejected() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"--log-level\", \"invalid\", \"detect\"])\n        .assert()\n        .failure()\n        .stderr(predicate::str::contains(\"Invalid log level\"));\n}\n```\n\n**Files to modify:**\n- tests/cli.rs\n\n**Acceptance:** All subcommands and flags have test coverage","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:33:08.375393-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.264237-06:00","closed_at":"2026-02-04T07:36:09.264237-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1fpm","title":"Adjust CLI no-args help test to match clap output","description":"Target: tests/cli.rs\n\nCurrent cli_without_args_shows_help expects failure + stderr. Clap typically prints help to stdout and exits 0 when arg_required_else_help is set. Update test to assert help text appears on stdout and tolerate success, or explicitly check both stdout/stderr for Usage without requiring failure.\n\nEnsure the test aligns with actual clap behavior to reduce flakiness.","acceptance_criteria":"- cli_without_args_shows_help passes reliably across clap versions.\n- Test checks output stream correctly (stdout vs stderr).\n- cargo test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-05T10:07:05.959406-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:13:27.868754-06:00","closed_at":"2026-02-05T10:13:27.868754-06:00","close_reason":"Closed","labels":["tests"]}
{"id":"upkeep-rs-1i3","title":"Fix rate limiting timing in crates_io.rs","description":"In src/core/analyzers/crates_io.rs:67-97, semaphore is held during sleep after request. Sleep should happen after acquiring permit but before request to ensure proper spacing between requests.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:32.798252-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.185746-06:00","closed_at":"2026-02-04T21:53:48.185746-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1td","title":"Set up GitHub Actions for CI/CD and multi-platform releases","description":"Create GitHub Actions workflows:\n\n1. CI workflow (.github/workflows/ci.yml):\n   - Trigger on push/PR\n   - Run cargo test --all-features\n   - Run cargo clippy -- -D warnings\n   - Run cargo fmt --check\n\n2. Release workflow (.github/workflows/release.yml):\n   - Trigger on tag push (v*)\n   - Build matrix:\n     - x86_64-unknown-linux-gnu (ubuntu-latest)\n     - aarch64-unknown-linux-gnu (ubuntu-latest + cross)\n     - x86_64-apple-darwin (macos-latest)\n     - aarch64-apple-darwin (macos-latest)\n     - x86_64-pc-windows-msvc (windows-latest)\n   - Use dtolnay/rust-toolchain@stable\n   - Upload artifacts\n   - Create GitHub Release with binaries\n\n3. Generate SHA256 checksums\n\n4. Add binstall metadata to Cargo.toml:\n   [package.metadata.binstall]\n   pkg-url = '{ repo }/releases/download/v{ version }/cargo-upkeep-{ target }'\n\nReference TS: .github/workflows in upkeep repo\n\nAcceptance: Pushing a tag creates release with binaries for all platforms","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:12.934648-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.448546-06:00","closed_at":"2026-02-05T13:28:51.448546-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-1xm","title":"Fix potential integer overflow in extract_unsafe_count","description":"In src/core/analyzers/unsafe_code.rs lines 310-323, casting u64 to usize with 'as' can silently truncate on 32-bit systems. Change from 'count as usize' to 'count.try_into().ok()' for safe conversion.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:23:55.425243-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.633221-06:00","closed_at":"2026-02-04T21:15:15.633221-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-213r","title":"Add CLI argument parsing tests","description":"Target: src/cli/mod.rs and src/cli/commands/mod.rs\n\nAdd unit tests for clap argument parsing:\n- Ensure global flags (--json, --verbose, --log-level) map into config.\n- Validate subcommand parsing and aliases (unsafe-code, tree).\n- Verify error messages for missing subcommand/unknown flag (case sensitivity).\n\nUse clap::Command::try_get_matches_from to avoid spawning processes.","acceptance_criteria":"- Parsing tests cover global flags and each subcommand.\n- Unknown flag/missing subcommand errors are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:54:02.903684-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:05:14.876044-06:00","closed_at":"2026-02-04T23:05:14.876044-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-24c","title":"Fix potential integer overflow in summarize()","description":"In src/core/analyzers/unsafe_code.rs:335-342, summarize() uses unchecked += for aggregating unsafe counts. While individual package counts use try_into().ok(), aggregation could overflow on 32-bit platforms. Use saturating_add() for consistency.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:17.255504-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.009933-06:00","closed_at":"2026-02-04T21:53:48.009933-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-25g","title":"ErrorResponse loses source chain context","description":"In src/core/error.rs lines 99-106, when converting UpkeepError to ErrorResponse, the source error chain is completely lost. Users only see the top-level message, not the underlying cause. Fix: Add a 'cause' field with the source error message, or concatenate the full chain in the message: format\\!(\"{error}: {source}\").","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:23:54.104623-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.533987-06:00","closed_at":"2026-02-04T21:15:15.533987-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-2de","title":"Initialize tracing subscriber for logging","description":"tracing and tracing-subscriber are dependencies but not initialized.\n\n**Issue:** Logging dependencies exist but no initialization code\n\n**Why it matters:**\n- --verbose and --log-level flags in spec require tracing setup\n- No logging output will appear without initialization\n- Debug/troubleshooting will be difficult\n- Users expect verbose mode to work\n\n**Fix:**\nCreate logging initialization in src/cli/mod.rs or src/main.rs:\n```rust\nuse tracing_subscriber::{fmt, EnvFilter};\n\npub fn init_logging(verbose: bool, log_level: Option\u003c\u0026str\u003e) {\n    let filter = log_level\n        .map(|l| EnvFilter::try_new(l).unwrap_or_default())\n        .unwrap_or_else(|| {\n            if verbose {\n                EnvFilter::new(\"info\")\n            } else {\n                EnvFilter::new(\"warn\")\n            }\n        });\n    \n    tracing_subscriber::fmt()\n        .with_env_filter(filter)\n        .with_writer(std::io::stderr)  // Keep stdout for JSON output\n        .init();\n}\n```\n\nCall from main() after parsing CLI args.\n\n**Files to modify:**\n- src/cli/mod.rs or src/main.rs\n\n**Acceptance:** --verbose flag produces info-level logs to stderr","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:24.024852-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.047991-06:00","closed_at":"2026-02-04T07:28:51.047991-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-2elv","title":"Document cargo-binstall install prerequisite","description":"Target: README.md\n\nAdd note that cargo-binstall must be installed and provide command:\n- cargo install cargo-binstall\n\nInclude link to cargo-binstall repository.","acceptance_criteria":"- README mentions cargo-binstall install command.\n- Link to https://github.com/cargo-bins/cargo-binstall.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T13:28:09.46431-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:52.201279-06:00","closed_at":"2026-02-05T13:28:52.201279-06:00","close_reason":"Closed","labels":["docs"]}
{"id":"upkeep-rs-2hi","title":"Fix deprecated Command::cargo_bin in tests","description":"Tests use deprecated assert_cmd API that may be removed.\n\n**Issue:** tests/cli.rs lines 6, 15, 24 - Using deprecated cargo_bin()\n\n**Warning:**\n```\nwarning: use of deprecated associated function `assert_cmd::Command::cargo_bin`: \nincompatible with a custom cargo build-dir, see instead `cargo::cargo_bin_cmd!`\n```\n\n**Why it matters:** Deprecated APIs may be removed in future versions, breaking tests.\n\n**Fix:**\nReplace Command::cargo_bin with cargo_bin_cmd! macro:\n\n```rust\nuse assert_cmd::cargo::cargo_bin_cmd;\n\n#[test]\nfn cli_without_args_shows_help() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .arg(\"upkeep\")\n        .assert()\n        .failure()\n        .stderr(predicate::str::contains(\"Usage\"));\n}\n\n#[test]\nfn cli_version_flag() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"--version\"])\n        .assert()\n        .success();\n}\n\n#[test]\nfn cli_help_flag() {\n    cargo_bin_cmd!(\"cargo-upkeep\")\n        .args([\"upkeep\", \"--help\"])\n        .assert()\n        .success();\n}\n```\n\n**Files to modify:**\n- tests/cli.rs\n\n**Acceptance:** cargo test runs without deprecation warnings","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:32:35.806167-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.263346-06:00","closed_at":"2026-02-04T07:36:09.263346-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-2th","title":"Tree: duplicate stats align with view","description":"Review feedback: TreeStats.duplicate_crates currently uses workspace-wide duplicates, which can mislead with --no-dev/--depth/--duplicates. Recompute duplicate count from displayed tree or rename stat to clarify.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T18:10:02.696962-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:13:00.984249-06:00","closed_at":"2026-02-04T18:13:00.984249-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-2vo","title":"Fix TOCTOU race condition in CratesIoClient cache","description":"In src/core/analyzers/crates_io.rs:47-66, fetch_latest_versions has race condition: cache is checked, lock released, then fetches happen. Multiple tasks with overlapping crates could both fetch same crate. Re-check cache inside loop after acquiring semaphore.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:37:06.175297-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.13-06:00","closed_at":"2026-02-04T22:48:50.13-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-303a","title":"Fix audit.rs test dependency on real project state","description":"In src/core/analyzers/audit.rs:289-323, dependency_graph_path_to_handles_matches_and_missing test loads real project Cargo.toml metadata, making it non-deterministic. Should use mock metadata or add defensive checks and document assumptions.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T23:26:37.392863-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:13.015284-06:00","closed_at":"2026-02-04T23:31:13.015284-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-31t","title":"Add context to semaphore acquire error","description":"Semaphore acquire error provides no context if it fails.\n\n**File:** src/core/analyzers/crates_io.rs line 125\n\n**Current:**\n```rust\nlet _permit = self.limiter.acquire().await?;\n```\n\n**Fix:**\n```rust\nlet _permit = self.limiter.acquire().await\n    .map_err(|_| anyhow::anyhow!(\"rate limiter semaphore closed unexpectedly\"))?;\n```\n\n**Acceptance:** Semaphore errors have descriptive message","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T11:42:55.37562-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.87441-06:00","closed_at":"2026-02-05T12:58:20.87441-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-35b","title":"Deps security: clarify scope","description":"Review feedback: deps --security reports only direct dependency vulnerabilities; clarify scope in output (warning or field) or include transitive vulnerabilities. Decide and implement for clear UX.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T22:15:53.519868-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:18:32.379065-06:00","closed_at":"2026-02-04T22:18:32.379065-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-3ns","title":"Add clippy analyzer parsing tests","description":"Target: src/core/analyzers/clippy.rs\n\nAdd unit tests for:\n- is_clippy_missing detection across common stderr messages.\n- JSON parsing: counts warnings/errors, warnings_by_lint, and detail extraction (primary span vs first span).\n- Ignore non-clippy codes and non warning/error diagnostics.\n- Synthetic error insertion when clippy exits non-zero and no errors parsed.\n\nUse representative JSON lines to exercise each branch.","acceptance_criteria":"- Tests cover warning/error counting and detail extraction.\n- Tests verify non-clippy lints and non-diagnostic lines are ignored.\n- Tests validate synthetic error behavior for failed clippy run.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:32:21.915374-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:02:44.059096-06:00","closed_at":"2026-02-04T23:02:44.059096-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-3rz","title":"Implement detect command - parse Cargo.toml and workspace","description":"Implemented detect command using cargo_metadata to output package/workspace metadata, tooling/CI detection, and JSON output support.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:21.630026-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T08:58:20.562397-06:00","closed_at":"2026-02-04T08:58:20.562397-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-3ysw","title":"Add CI dependency caching","description":"In .github/workflows/ci.yml:14-26, no Cargo/target caching. Add actions/cache for faster CI runs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:49:21.289099-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.722469-06:00","closed_at":"2026-02-05T14:04:28.722469-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-43a","title":"Use \u0026Path instead of \u0026PathBuf in unused.rs","description":"In src/core/analyzers/unused.rs lines 32, 64, 92, three functions take \u0026PathBuf instead of \u0026Path. Same anti-pattern as unsafe_code.rs. Functions: run_machete_json, run_machete_plain, run_machete.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:23:54.62605-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.600974-06:00","closed_at":"2026-02-04T21:15:15.600974-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-43k","title":"Avoid unnecessary Package clone in tree.rs","description":"In src/cli/commands/tree.rs:57, Package struct is cloned when inserted into HashMap. Consider storing references if lifetimes permit, or storing indices to avoid the clone.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:32.42073-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.365052-06:00","closed_at":"2026-02-04T21:53:48.365052-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-44n9","title":"Extend tree integration coverage for features/dev flags","description":"Target: tests/tree.rs\n\nAdd coverage for --features output and is_dev/is_build flags:\n- Include feature flags in at least one dependency and assert JSON includes features array when --features is used.\n- Assert dev dependency nodes include is_dev=true when no --no-dev, and is_build where applicable if fixture includes build dep.\n\nUse existing tree fixture; add minimal extra deps/feature sections.","acceptance_criteria":"- Tests assert features array in JSON when --features used.\n- Tests assert is_dev/is_build flags appropriately.\n- cargo test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-05T10:07:06.124316-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:13:28.221124-06:00","closed_at":"2026-02-05T10:13:28.221124-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-469","title":"Implement crates.io version fetcher for dependency analysis","description":"Added crates.io version fetcher with crates-index + API fallback, rate limiting, caching, and prerelease filtering in src/core/analyzers/crates_io.rs.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:45.441064-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:22:40.851288-06:00","closed_at":"2026-02-04T09:22:40.851288-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-49f","title":"Verify TreeArgs Clone derive is needed","description":"In src/cli/mod.rs:59, TreeArgs derives Clone but it's unclear if needed. Unnecessary Clone can hide ownership issues. Verify it's needed; if not, remove it.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:46.550618-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.482704-06:00","closed_at":"2026-02-04T21:53:48.482704-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-4aq","title":"Implement audit command - RustSec security vulnerability scanning","description":"Create src/cli/commands/audit.rs using the rustsec crate:\n\n1. Use rustsec crate directly (not shelling out):\n   let db = Database::fetch()?;\n   let lockfile = Lockfile::load('Cargo.lock')?;\n   let vulnerabilities = db.query_vulnerabilities(\u0026lockfile);\n\n2. Map vulnerabilities to structured format:\n   VulnerabilityInfo {\n     id: String,           // RUSTSEC-2023-XXXX\n     package: String,\n     severity: Severity,\n     title: String,\n     description: String,\n     url: String,\n     patched_versions: Vec\u003cString\u003e,\n     unaffected_versions: Vec\u003cString\u003e,\n   }\n\n3. Determine severity from CVSS score or advisory field\n4. Build dependency path showing transitive deps\n5. Provide fix recommendations:\n   - If patched version exists: 'Upgrade to X.Y.Z'\n   - If no patch: Suggest alternatives\n\n6. Return AuditOutput with summary counts by severity\n\nReference TS: src/cli/commands/audit.ts, src/lib/analyzers/audit.ts\n\nAcceptance: cargo run -- audit scans Cargo.lock and reports vulnerabilities","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:51.367019-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:22:59.268769-06:00","closed_at":"2026-02-04T12:22:59.268769-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-4b7r","title":"Add checksum verification to install.sh","description":"SECURITY: scripts/install.sh:120-122 downloads and executes binary without checksum verification. Add SHA256 checksum verification against checksums file in release assets.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-05T13:49:21.046387-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.718092-06:00","closed_at":"2026-02-05T14:04:28.718092-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-4b93","title":"Clean duplicate Result import in run_with helper","description":"Target: src/cli/commands/run_with.rs\n\nRemove duplicate Result import to avoid redundant-import warnings.\n\nKeep behavior unchanged.","acceptance_criteria":"- Duplicate import removed.\n- cargo fmt passes.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T10:16:45.323522-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:17:31.861927-06:00","closed_at":"2026-02-05T10:17:31.861927-06:00","close_reason":"Closed","labels":["refactor"]}
{"id":"upkeep-rs-4bp","title":"BUG: Fix workspace field always returning true","description":"The workspace field is always true even for single-package projects.\n\n**File:** src/cli/commands/detect.rs line 45-46\n\n**Bug:**\n```rust\nworkspace: !metadata.workspace_members.is_empty(),\n```\n\nEven a single-package project has itself as a workspace member, so this is always true.\n\n**Why it matters:** Users expect workspace: false for single-crate projects, workspace: true only for multi-crate workspaces. This is incorrect data being reported.\n\n**Fix:**\n```rust\nworkspace: metadata.workspace_members.len() \u003e 1,\n```\n\n**Acceptance:** Single-crate project shows workspace: false, multi-crate workspace shows workspace: true","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:00:20.894143-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:10:38.185196-06:00","closed_at":"2026-02-04T09:10:38.185199-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-4c4","title":"Add debug logging when text parsing finds no results","description":"In src/core/analyzers/unused.rs:249-312, parse_machete_text silently returns empty if format changes. Add debug logging when parsing finds no results to help diagnose format changes from machete updates.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:27:38.437012-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.451242-06:00","closed_at":"2026-02-04T22:33:21.451242-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-4nm","title":"Fix case sensitivity in is_missing_subcommand and is_unknown_flag","description":"CRITICAL: In src/core/analyzers/external_tool.rs:100-114, tool_name and flag_name are not lowercased before comparison with lowercased stderr. If tool name has different case in error message, detection fails. Fix: lower.contains(\u0026tool_name.to_lowercase())","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-04T22:27:25.178364-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.27683-06:00","closed_at":"2026-02-04T22:33:21.27683-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-4tp","title":"Create separate command modules per spec structure","description":"Spec defines separate files for each command but all logic is in single mod.rs.\n\n**File:** src/cli/commands/mod.rs\n\n**Spec structure (docs/spec.md:66-77):**\n```\nsrc/cli/commands/\n├── mod.rs          # Just re-exports and dispatch\n├── detect.rs\n├── deps.rs\n├── audit.rs\n├── quality.rs\n├── unused.rs\n├── unsafe_code.rs  # Named to avoid keyword\n└── tree.rs\n```\n\n**Why it matters:** As commands are implemented, single file becomes unwieldy. Spec structure supports better separation of concerns.\n\n**Fix:**\n1. Create individual command files\n2. Move dispatch to mod.rs\n3. Each file exports a run() or execute() function\n\nExample detect.rs:\n```rust\nuse anyhow::Result;\n\npub async fn run(json: bool) -\u003e Result\u003c()\u003e {\n    if json {\n        // JSON output\n    } else {\n        // Human output\n    }\n    anyhow::bail!(\"detect not yet implemented\")\n}\n```\n\n**Acceptance:** Each command has its own file matching spec structure","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:33.513018-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:46.859262-06:00","closed_at":"2026-02-04T21:21:46.859262-06:00","close_reason":"DONE: Commands in src/cli/commands/ - detect.rs, deps.rs, audit.rs, tree.rs, unused.rs, unsafe_code.rs"}
{"id":"upkeep-rs-4x4","title":"Fix quality scorer hardcoded unused_score and unsafe_score","description":"In src/core/scorers/quality.rs:45-46, unused_score and unsafe_score are hardcoded to 100.0 instead of using actual analysis results. Either connect to real data or remove from breakdown until implemented.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:27:27.384467-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.391969-06:00","closed_at":"2026-02-04T22:33:21.391969-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-502","title":"Deps: clarify --security behavior","description":"Review feedback: --security currently just logs and returns OK. Either surface a structured not-implemented error or add explicit output indicating audit is unavailable.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.854884-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.766236-06:00","closed_at":"2026-02-05T12:58:20.766236-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-55c","title":"Change confidence from string to enum","description":"In src/core/analyzers/unused.rs:188-189, confidence uses string constants (\"high\", \"medium\"). Create Confidence enum in output.rs with High/Medium/Low variants for type safety and prevent typos.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:27:26.943653-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.36346-06:00","closed_at":"2026-02-04T22:33:21.36346-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5a9","title":"Return error for invalid log level instead of silent fallback","description":"Invalid log levels silently fall back to 'warn' without informing user.\n\n**Issue:** src/cli/mod.rs lines 49-50 - Silent fallback on invalid input\n\n**Current:**\n```rust\nSome(level) =\u003e EnvFilter::try_new(level).unwrap_or_else(|_| EnvFilter::new(\"warn\")),\n```\n\n**Why it matters:** If user types '--log-level=degub' (typo), they get warn-level logging with no feedback that their input was ignored. Confusing UX.\n\n**Fix:**\nChange init_logging to return Result and propagate the error:\n```rust\npub fn init_logging(verbose: bool, log_level: Option\u003c\u0026str\u003e) -\u003e Result\u003c()\u003e {\n    let filter = match log_level {\n        Some(level) =\u003e EnvFilter::try_new(level)\n            .map_err(|e| anyhow::anyhow\\!(\"Invalid log level '{}': {}\", level, e))?,\n        None if verbose =\u003e EnvFilter::new(\"info\"),\n        None =\u003e EnvFilter::new(\"warn\"),\n    };\n    // ...\n}\n```\n\nThen in main.rs, the error will propagate and show user-friendly message.\n\n**Files to modify:**\n- src/cli/mod.rs (init_logging function)\n\n**Acceptance:** cargo run -- upkeep --log-level=invalid detect shows clear error message","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:32:33.308849-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.257811-06:00","closed_at":"2026-02-04T07:36:09.257811-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5c2","title":"Add test for multi-member workspace (workspace: true)","description":"Integration test only covers single-package project (workspace: false), no test for positive case.\n\n**File:** tests/detect.rs\n\n**Why it matters:** The workspace field logic (len() \u003e 1) was a previous bug. Without a test for the positive case, a regression could go undetected.\n\n**Fix:**\nAdd integration test that creates workspace with 2+ members:\n```rust\n#[test]\nfn detect_outputs_workspace_true_for_multi_member() {\n    let temp_dir = tempfile::tempdir().expect(\"temp dir\");\n    let root = temp_dir.path();\n\n    // Create workspace Cargo.toml\n    fs::write(\n        root.join(\"Cargo.toml\"),\n        \"[workspace]\\nmembers = [\\\"crate_a\\\", \\\"crate_b\\\"]\\n\",\n    ).expect(\"write workspace Cargo.toml\");\n\n    // Create crate_a and crate_b with minimal Cargo.toml and src/lib.rs\n    // ... (see full implementation in review)\n\n    let output = cargo_bin_cmd!(\"cargo-upkeep\")\n        .current_dir(root)\n        .args([\"detect\", \"--json\"])\n        .output()\n        .expect(\"run detect\");\n\n    assert!(output.status.success());\n    let json: Value = serde_json::from_str(...).expect(\"parse json\");\n    assert_eq!(json[\"workspace\"], true);\n    assert_eq!(json[\"members\"].as_array().unwrap().len(), 2);\n}\n```\n\n**Acceptance:** Test verifies workspace: true for multi-member workspace","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:10:25.53579-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:14:41.764547-06:00","closed_at":"2026-02-04T09:14:41.76455-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5d6","title":"Fix prerelease handling returning None incorrectly","description":"CRITICAL: In src/core/analyzers/crates_io.rs:103-128, if max_stable_version is None and max_version is prerelease, selected version becomes None even though a version exists. Users see 'no version available' for crates with only prereleases. Fix: fall back to prerelease with warning or clarify intent.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-04T22:27:25.619976-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.306745-06:00","closed_at":"2026-02-04T22:33:21.306745-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5gp","title":"Initialize Rust project with Cargo workspace structure","description":"Create the initial cargo-upkeep project structure:\n\n1. Initialize a new Rust binary crate with cargo init --name cargo-upkeep\n2. Set up Cargo.toml with dependencies:\n   - clap = \"4.0\" (with derive feature)\n   - serde = { version = \"1.0\", features = [\"derive\"] }\n   - serde_json = \"1.0\"\n   - toml = \"0.8\"\n   - cargo_metadata = \"0.18\"\n   - rustsec = \"0.29\"\n   - crates-index = \"2.0\"\n   - tracing/tracing-subscriber for logging\n   - thiserror/anyhow for errors\n   - tokio for async runtime\n   - reqwest for HTTP\n   - semver = \"1.0\"\n\n3. Create directory structure per spec:\n   src/\n   ├── main.rs\n   ├── cli/\n   │   ├── mod.rs\n   │   └── commands/\n   └── lib/\n       ├── mod.rs\n       ├── analyzers/\n       ├── scorers/\n       └── output.rs\n\n4. Configure Cargo.toml metadata: edition 2021, license MIT, rust-version 1.70\n5. Create .gitignore\n\nAcceptance: cargo build succeeds with basic main.rs placeholder","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:05:33.413803-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:16:42.991325-06:00","closed_at":"2026-02-04T07:16:42.991325-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5hs5","title":"Document assert_close tolerance constant","description":"In src/core/scorers/quality.rs:235-240, assert_close uses 0.01 tolerance magic number. Add a const with documentation explaining the tolerance choice.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:32:55.354645-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:37:03.540695-06:00","closed_at":"2026-02-05T09:37:03.540695-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5lw","title":"Add missing --json global flag to CLI","description":"The spec requires a --json global flag but it's not implemented.\n\n**Issue:** src/cli/mod.rs lines 30-37 - UpkeepCli struct missing json flag\n\n**Current:**\n```rust\npub struct UpkeepCli {\n    #[arg(short, long, global = true)]\n    pub verbose: bool,\n    #[arg(long, global = true)]\n    pub log_level: Option\u003cString\u003e,\n    #[command(subcommand)]\n    pub command: UpkeepCommand,\n}\n```\n\n**Why it matters:** Spec states '--json # JSON output (default for most commands)' is required. All commands should support JSON output format.\n\n**Fix:**\n```rust\npub struct UpkeepCli {\n    #[arg(short, long, global = true)]\n    pub verbose: bool,\n    \n    /// Output results as JSON\n    #[arg(long, global = true)]\n    pub json: bool,\n    \n    #[arg(long, global = true)]\n    pub log_level: Option\u003cString\u003e,\n    \n    #[command(subcommand)]\n    pub command: UpkeepCommand,\n}\n```\n\n**Files to modify:**\n- src/cli/mod.rs\n\n**Acceptance:** cargo run -- upkeep --json detect is accepted, json field accessible in handlers","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:32:10.825888-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.203046-06:00","closed_at":"2026-02-04T07:36:09.203046-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5mz","title":"BUG: Dead cycle detection code in tree.rs (lines 264-267)","description":"In src/cli/commands/tree.rs lines 264-267, the cycle detection code is dead code that never executes:\n\n```rust\nif path.contains(id) {\n    return Ok(Some(node));\n}\npath.insert(id.clone());\n```\n\nThe check on line 264 happens AFTER the expanded.insert() check at line 256. If we just inserted into expanded, the id can't be in path yet (we haven't inserted into path). \n\nCycles are actually caught by line 283 `if path.contains(\u0026child.id)` which skips children that are ancestors.\n\nImpact: Low - cycles are still handled correctly, but there's dead/confusing code.\n\nFix: Remove the dead code at lines 264-267:\n```rust\n// Remove these lines:\nif path.contains(id) {\n    return Ok(Some(node));\n}\n```\n\nKeep the path.insert(id.clone()) for actual cycle detection via the child check.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T18:37:33.119904-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:44:41.231986-06:00","closed_at":"2026-02-04T18:44:41.231986-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-5y2","title":"Add integration tests for detect command","description":"The detect command has no integration test coverage.\n\n**File:** tests/cli.rs\n\n**Why it matters:** First real implementation has no tests - regressions could ship undetected.\n\n**Fix:**\nAdd tests that verify detect runs and produces valid output:\n```rust\n#[test]\nfn detect_command_produces_json() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"detect\", \"--json\"])\n        .assert()\n        .success()\n        .stdout(predicate::str::contains(\"edition\"))\n        .stdout(predicate::str::contains(\"workspace\"));\n}\n\n#[test]\nfn detect_command_produces_human_output() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"detect\"])\n        .assert()\n        .success()\n        .stdout(predicate::str::contains(\"Package:\"));\n}\n```\n\n**Acceptance:** detect command has integration test coverage for both JSON and human output","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:04:17.19902-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:10:38.383182-06:00","closed_at":"2026-02-04T09:10:38.383184-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-64t","title":"Fix path HashSet not cleared on error in build_node","description":"In src/cli/commands/tree.rs:270-299, ctx.path.insert() is called but ctx.path.remove() is not reached on early error return from recursive build_node. Use a scope guard pattern (Drop impl) to ensure cleanup.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:18.360915-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.0699-06:00","closed_at":"2026-02-04T21:53:48.0699-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-6gh","title":"Add integration test for human-readable detect output","description":"Integration test only validates --json output, not human-readable Display format.\n\n**File:** tests/detect.rs\n\n**Why it matters:** Display impl could have formatting bugs. It was just fixed for missing fields - test prevents future regressions.\n\n**Fix:**\nAdd test without --json flag:\n```rust\n#[test]\nfn detect_outputs_human_readable_format() {\n    let temp_dir = tempfile::tempdir().expect(\"temp dir\");\n    // ... create minimal project ...\n\n    let output = cargo_bin_cmd!(\"cargo-upkeep\")\n        .current_dir(root)\n        .args([\"detect\"])  // No --json\n        .output()\n        .expect(\"run detect\");\n\n    assert!(output.status.success());\n    let stdout = String::from_utf8(output.stdout).unwrap();\n    assert!(stdout.contains(\"Package: detect-test\"));\n    assert!(stdout.contains(\"Workspace: false\"));\n    assert!(stdout.contains(\"Features:\"));\n    assert!(stdout.contains(\"Tooling:\"));\n    assert!(stdout.contains(\"CI:\"));\n}\n```\n\n**Acceptance:** Human-readable output format has test coverage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:10:26.61989-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:14:55.179401-06:00","closed_at":"2026-02-04T23:14:55.179401-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-6ju","title":"Unused: handle unexpected JSON schema","description":"Review feedback: if cargo machete --json returns valid JSON with unrecognized schema, parser silently falls back to text and may report empty results. Add explicit error or schema detection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T18:10:02.804067-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:13:01.204619-06:00","closed_at":"2026-02-04T18:13:01.204619-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-6pc7","title":"Remove unused _args parameter from tree emit_output_with","description":"In tree.rs:167, emit_output_with takes _args: \u0026TreeArgs but doesn't use it. Remove to simplify signature.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:03:34.546749-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.618754-06:00","closed_at":"2026-02-05T13:07:58.618754-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-6y3","title":"Implement proper error handling with anyhow::Result in main","description":"main() returns () instead of Result, preventing proper exit codes.\n\n**Issue:** src/main.rs line 8 - main() returns unit type ()\n\n**Why it matters:**\n- CLI tools should return proper exit codes (0 for success, non-zero for failure)\n- anyhow is already a dependency but unused\n- Errors will cause panics instead of graceful exits\n- No error propagation with ? operator possible\n\n**Fix:**\n```rust\nuse anyhow::Result;\n\nfn main() -\u003e Result\u003c()\u003e {\n    // ... implementation\n    Ok(())\n}\n```\n\nOr with tokio:\n```rust\n#[tokio::main]\nasync fn main() -\u003e Result\u003c()\u003e {\n    // ... implementation\n    Ok(())\n}\n```\n\n**Files to modify:**\n- src/main.rs\n\n**Acceptance:** main returns anyhow::Result\u003c()\u003e, errors produce non-zero exit codes","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:22:39.390633-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:50.983389-06:00","closed_at":"2026-02-04T07:28:50.983389-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-6zs","title":"Preserve error context in parse_geiger_output","description":"In src/core/analyzers/unsafe_code.rs:26-50, when geiger fails and JSON parsing also fails, the original parsing error is discarded. Include it in the constructed error: format!(\"cargo geiger failed (stderr: {stderr}); parsing also failed: {err}\").","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:17.622045-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.041264-06:00","closed_at":"2026-02-04T21:53:48.041264-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-732","title":"Add Cargo.lock to git for reproducible CLI builds","description":"Cargo.lock exists but may not be tracked in git.\n\n**Issue:** Cargo.lock shown as untracked in git status\n\n**Why it matters:**\n- CLI tools should have reproducible builds\n- Different dependency resolutions cause inconsistent behavior\n- Security audits need pinned versions\n- CI builds should match local builds\n\n**Fix:**\n1. Ensure .gitignore does NOT ignore Cargo.lock\n2. Add Cargo.lock to git:\n   ```bash\n   git add Cargo.lock\n   git commit -m 'Add Cargo.lock for reproducible builds'\n   ```\n\nNote: Libraries should NOT commit Cargo.lock, but binaries/CLIs SHOULD.\n\n**Files to modify:**\n- .gitignore (ensure Cargo.lock not ignored)\n- git add Cargo.lock\n\n**Acceptance:** Cargo.lock is tracked in git","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:50.989802-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.164999-06:00","closed_at":"2026-02-04T07:36:09.164999-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-745","title":"Add dev-dependencies for testing (assert_cmd, predicates, tempfile)","description":"No test utilities specified in Cargo.toml.\n\n**Issue:** Missing dev-dependencies section for testing\n\n**Why it matters:**\n- Integration testing CLI tools requires assert_cmd\n- Predicate matching needs predicates crate\n- Temp directories for test fixtures need tempfile\n- Cannot write proper tests without these utilities\n\n**Fix:**\nAdd to Cargo.toml:\n```toml\n[dev-dependencies]\nassert_cmd = \"2.0\"\npredicates = \"3.0\"\ntempfile = \"3.0\"\n```\n\n**Files to modify:**\n- Cargo.toml\n\n**Acceptance:** cargo test compiles, test utilities are available","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:22:58.324769-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.001329-06:00","closed_at":"2026-02-04T07:28:51.001329-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-783n","title":"Adjust install.sh default install dir","description":"Problem: install.sh defaults to ~/.local/bin, but original acceptance suggests preferring ~/.cargo/bin then /usr/local/bin.\n\nFix: Update install.sh to prefer ~/.cargo/bin if writable, else /usr/local/bin if writable, else ~/.local/bin; still allow INSTALL_DIR override.\n\nAcceptance:\n- Default path preference updated.\n- INSTALL_DIR override still works.","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-05T13:29:45.827252-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:29:45.827252-06:00","labels":["docs"]}
{"id":"upkeep-rs-7ky","title":"Define core output types in output.rs","description":"Core modules exist but contain nothing except placeholder tests.\n\n**File:** src/core/output.rs (empty)\n\n**Why it matters:** Module structure is correct per spec, but no types defined. For MVP, output.rs needs JSON output types.\n\n**Fix:**\nDefine serializable output types:\n```rust\nuse serde::Serialize;\n\n/// Generic wrapper for all command outputs\n#[derive(Debug, Serialize)]\npub struct CommandOutput\u003cT: Serialize\u003e {\n    pub success: bool,\n    #[serde(flatten)]\n    pub data: T,\n}\n\n/// Output for detect command\n#[derive(Debug, Serialize)]\npub struct DetectOutput {\n    pub name: String,\n    pub version: String,\n    pub edition: String,\n    pub msrv: Option\u003cString\u003e,\n    pub workspace: bool,\n    pub members: Vec\u003cString\u003e,\n}\n\n/// Output for deps command\n#[derive(Debug, Serialize)]\npub struct DepsOutput {\n    pub total: usize,\n    pub outdated: usize,\n    pub major: usize,\n    pub minor: usize,\n    pub patch: usize,\n}\n\n// Add more as commands are implemented\n```\n\n**Acceptance:** output.rs has serializable types for each command","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:33.98456-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:46.535009-06:00","closed_at":"2026-02-04T21:21:46.535009-06:00","close_reason":"DONE: Comprehensive types in output.rs - DetectOutput, DepsOutput, UnusedOutput, etc."}
{"id":"upkeep-rs-7o8","title":"Add unit tests for core modules","description":"Create comprehensive unit tests for all core modules:\n\n1. Tests for semver utilities:\n   - Test version parsing\n   - Test update type classification (major/minor/patch)\n   - Test version comparison\n   - Test pre-release version handling\n\n2. Tests for output serialization:\n   - Test all output types serialize correctly\n   - Test error output format\n   - Test enum serialization (Grade, Severity, UpdateType)\n\n3. Tests for quality scoring:\n   - Test individual metric calculations\n   - Test weighted score aggregation\n   - Test grade boundaries (A/B/C/D/F thresholds)\n   - Test recommendation generation\n\n4. Tests for analyzers:\n   - Mock cargo metadata responses\n   - Test parsing of various Cargo.toml formats\n   - Test workspace detection\n   - Test CI config detection\n\n5. Test fixtures:\n   - Create test Cargo.toml files in tests/fixtures/\n   - Create mock crates.io responses\n   - Create mock clippy output\n\nReference TS: Tests throughout src/ with .internals and .parsers exports\n\nAcceptance: cargo test passes with \u003e80% coverage on core logic","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:08:53.834936-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.325275-06:00","closed_at":"2026-02-05T12:58:20.325275-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-7v9","title":"Refactor tree.rs build functions to use context struct","description":"In src/cli/commands/tree.rs lines 160, 229, build_node takes 11 args and build_inverted_root takes 8. Introduce a TreeBuildContext struct to group graph, packages_by_id, features_by_id, args, duplicate_names. Removes need for #[allow(clippy::too_many_arguments)].","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:07.460512-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.762765-06:00","closed_at":"2026-02-04T21:15:15.762765-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-7xv","title":"Add explicit [[bin]] section to Cargo.toml","description":"No explicit binary configuration for cargo subcommand integration.\n\n**Issue:** Missing [[bin]] section means relying on default naming\n\n**Why it matters:**\n- For 'cargo upkeep' to work, binary must be named 'cargo-upkeep'\n- Explicit is better than implicit for cargo plugins\n- Documents the intended binary name\n- Allows future multiple binaries if needed\n\n**Fix:**\nAdd to Cargo.toml:\n```toml\n[[bin]]\nname = \"cargo-upkeep\"\npath = \"src/main.rs\"\n```\n\n**Files to modify:**\n- Cargo.toml\n\n**Acceptance:** cargo build produces cargo-upkeep binary, cargo upkeep works","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:22:58.010961-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.014359-06:00","closed_at":"2026-02-04T07:28:51.014359-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-88c","title":"Deps: handle non-registry deps","description":"Review feedback: non-registry deps (path/git/other registry) are queried against crates.io and then silently dropped. Decide whether to skip with explicit reporting or include a non_registry flag/placeholder in output.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.442024-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:37.161381-06:00","closed_at":"2026-02-04T21:21:37.161381-06:00","close_reason":"DONE: Non-registry deps detected and skipped with SkipReason::NonRegistry"}
{"id":"upkeep-rs-894x","title":"Add crates.io client tests with mocked HTTP","description":"Target: src/core/analyzers/crates_io.rs\n\nAdd unit tests that mock the crates.io API to validate version selection and caching:\n- allow_prerelease=true selects max_version (falls back to max_stable_version).\n- allow_prerelease=false selects max_stable_version (falls back to max_version).\n- Missing versions produce latest=None with latest_stable preserved.\n- Cache hit avoids repeated HTTP calls for same crate.\n\nMay require refactor to inject base URL or HTTP client for tests (e.g., wiremock/httpmock). Keep production behavior unchanged.","acceptance_criteria":"- Tests mock HTTP responses without hitting crates.io.\n- Selection logic for prerelease/stable is covered with asserts.\n- Cache behavior verified (single request per crate).\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:53:09.942895-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:13:58.113218-06:00","closed_at":"2026-02-04T23:13:58.113218-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-8ak","title":"Add unsafe analyzer JSON parsing tests","description":"Target: src/core/analyzers/unsafe_code.rs\n\nAdd unit tests for JSON parsing paths:\n- packages array, crate_stats array, and top-level array schemas.\n- parse_package name/version fallback from id, name/crate, package.name, and default version.\n- stats extraction for functions/impls/traits/blocks/exprs across alternate keys.\n- missing identifiers -\u003e InvalidData error when all entries lack id/name.\n\nUse small JSON fixtures to cover each schema and error path.","acceptance_criteria":"- Tests cover all supported geiger JSON schemas.\n- Tests validate field fallbacks and total_unsafe aggregation.\n- Missing identifiers error is asserted for invalid schemas.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:32:34.81241-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:04:15.21252-06:00","closed_at":"2026-02-04T23:04:15.21252-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-8bk","title":"Add id field to Vulnerability struct","description":"Vulnerability struct missing advisory ID field.\n\n**File:** src/core/output.rs lines 72-78\n\n**Issue:** No id field for RUSTSEC advisory ID.\n\n**Why it matters:** When audit command is implemented, users need advisory IDs to look up details and track fixes.\n\n**Fix:**\n```rust\npub struct Vulnerability {\n    pub id: String,  // e.g., \"RUSTSEC-2023-0001\"\n    pub package: String,\n    pub severity: Severity,\n    pub title: String,\n    pub path: Vec\u003cString\u003e,\n    pub fix_available: bool,\n}\n```\n\n**Acceptance:** Vulnerability struct has id field","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:04:32.903205-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.549115-06:00","closed_at":"2026-02-05T12:58:20.549115-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-8bv","title":"Fix redundant match arm in deps.rs","description":"In src/cli/commands/deps.rs:91-94, DependencyKind::Normal arm and _ wildcard have identical bodies (both return DependencyType::Normal). Remove explicit Normal arm or restructure for clarity.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:32.050146-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.15636-06:00","closed_at":"2026-02-04T21:53:48.15636-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-8k6","title":"Deps: handle renamed deps in resolve mapping","description":"Review feedback: current deps command keys resolved versions by resolve dep name but looks up by dependency name, so renamed deps are missed. Update mapping to use PackageId or dep.rename, and correlate root_package.dependencies with resolve node entries.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.341161-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:37.480312-06:00","closed_at":"2026-02-04T21:21:37.480312-06:00","close_reason":"DONE: Renamed deps handled via dep.rename lookup, aliases included in output"}
{"id":"upkeep-rs-8ot","title":"Extract describe_json_schema to shared module","description":"The exact same describe_json_schema function exists in both src/core/analyzers/unsafe_code.rs (lines 348-361) and src/core/analyzers/unused.rs (lines 376-389). Move to shared module like src/core/util.rs or add to src/core/output.rs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:08.567792-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.82632-06:00","closed_at":"2026-02-04T21:15:15.82632-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-8qw","title":"Add unused analyzer JSON parsing tests","description":"Target: src/core/analyzers/unused.rs\n\nAdd unit tests for JSON parsing paths:\n- null -\u003e empty unused/possibly_unused.\n- array of strings/objects -\u003e UnusedDep entries with default/high confidence.\n- object schema with manifests[] and unused/possibly_unused sections.\n- dependency_type parsing for normal/dev/build and confidence mapping (high/medium/low).\n- invalid schema returns InvalidData with schema description.\n\nNote: parse_machete_text has a separate test task (upkeep-rs-qy0); avoid duplicating it here.","acceptance_criteria":"- Tests cover JSON array and object schemas with expected UnusedDep output.\n- Tests validate dependency_type + confidence parsing.\n- Invalid schema produces InvalidData error.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:32:29.098028-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:03:23.312354-06:00","closed_at":"2026-02-04T23:03:23.312354-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-8r8","title":"BUG: Float comparison with unwrap_or could silently produce incorrect ordering","description":"In quality.rs line 172:\n```rust\nitems.sort_by(|a, b| b.0.partial_cmp(\u0026a.0).unwrap_or(Ordering::Equal));\n```\n\nWhile unwrap_or(Ordering::Equal) handles NaN safely, the code could silently produce incorrect ordering if NaN values sneak in. This is a latent bug if any scoring function ever returns NaN.\n\nFix: Use total_cmp (available since Rust 1.62, and our MSRV is 1.70):\n```rust\nitems.sort_by(|a, b| b.0.total_cmp(\u0026a.0));\n```\n\nThis provides a total ordering for f32 values including NaN.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T17:45:24.139216-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T17:52:23.507713-06:00","closed_at":"2026-02-04T17:52:23.507713-06:00","close_reason":"Fixed: conditional synthetic error, added allow(dead_code), standardized score calculation with saturating_sub, use total_cmp for float sorting"}
{"id":"upkeep-rs-8wu","title":"Tree: avoid empty version label","description":"Review feedback: Tree label shows 'v' even when version empty (synthetic invert root). Update format_label to omit version segment for empty version.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T18:10:02.586076-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:13:00.762796-06:00","closed_at":"2026-02-04T18:13:00.762796-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-90g","title":"Add async runtime setup with tokio::main","description":"Tokio is declared as a dependency but main() is synchronous.\n\n**Issue:** src/main.rs line 6-8 has synchronous main() but Cargo.toml declares tokio with rt-multi-thread feature.\n\n**Why it matters:**\n- Tokio dependency adds compile time and binary size\n- crates.io API calls will need async\n- rustsec database fetching benefits from async\n- Current setup is inconsistent (dep declared but unused)\n\n**Fix:**\nUpdate src/main.rs:\n```rust\nuse anyhow::Result;\nuse clap::Parser;\n\nmod cli;\nmod core;\n\n#[tokio::main]\nasync fn main() -\u003e Result\u003c()\u003e {\n    let cli = cli::Cli::parse();\n    // Initialize logging based on cli.verbose\n    // Dispatch to commands\n    Ok(())\n}\n```\n\n**Files to modify:**\n- src/main.rs\n\n**Acceptance:** main() is async, returns Result, tokio runtime is active","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:22:37.583867-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:51.012454-06:00","closed_at":"2026-02-04T07:28:51.012454-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-98g","title":"Prepare for crates.io publishing","description":"Prepare the crate for publishing to crates.io:\n\n1. Verify Cargo.toml metadata:\n   [package]\n   name = 'cargo-upkeep'\n   version = '0.1.0'\n   edition = '2021'\n   authors = ['...']\n   description = 'Unified Rust project maintenance CLI'\n   license = 'MIT'\n   repository = 'https://github.com/llbbl/cargo-upkeep'\n   homepage = '...'\n   documentation = 'https://docs.rs/cargo-upkeep'\n   readme = 'README.md'\n   keywords = ['cargo', 'maintenance', 'security', 'audit']\n   categories = ['development-tools::cargo-plugins', 'command-line-utilities']\n   rust-version = '1.70'\n\n2. Add license file (LICENSE-MIT)\n\n3. Verify package contents: cargo package --list\n\n4. Run cargo publish --dry-run\n\n5. Add binstall metadata:\n   [package.metadata.binstall]\n   pkg-url = '{ repo }/releases/download/v{ version }/cargo-upkeep-{ target }'\n\n6. Set up crates.io API token in GitHub secrets\n\n7. Create CHANGELOG.md with initial release notes\n\nAcceptance: cargo publish --dry-run succeeds without errors","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:54.600993-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.988496-06:00","closed_at":"2026-02-05T13:28:51.988496-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-99o","title":"Add directory context to metadata error in tree.rs","description":"In src/cli/commands/tree.rs lines 16-19, the error message 'failed to load cargo metadata' is generic. Include the current directory in the error message to help users understand which workspace failed.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:24:07.196953-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.986002-06:00","closed_at":"2026-02-04T21:15:15.986002-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-9az","title":"Implement unused deps command - detect unused dependencies","description":"Create src/cli/commands/unused.rs for unused dependency detection (Phase 2):\n\n1. Approach options:\n   - Option A: Shell out to cargo-machete (simpler, external dep)\n   - Option B: Reimplement cargo-machete logic (more control)\n   - Option C: Use cargo-udeps (requires nightly)\n\n2. For MVP (Option A):\n   cargo machete\n   Parse output for unused crates\n\n3. For long-term (Option B):\n   - Parse Cargo.toml for declared dependencies\n   - Scan all .rs files for use crate_name:: and extern crate\n   - Compare declared vs used\n   - Handle renamed imports\n\n4. Output structure:\n   UnusedOutput {\n     unused: Vec\u003cUnusedDep\u003e,\n     possibly_unused: Vec\u003cString\u003e,  // Could be used via macros\n   }\n   UnusedDep { name, dep_type, confidence }\n\n5. Handle edge cases:\n   - Proc macro crates\n   - Build script dependencies\n   - Feature-gated dependencies\n\nAcceptance: cargo run -- unused detects unused dependencies","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:35.513189-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:13:01.426524-06:00","closed_at":"2026-02-04T18:13:01.426524-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-a2b","title":"Implement clap CLI skeleton with cargo subcommand pattern","description":"No CLI argument parsing is implemented despite clap being a dependency.\n\n**Issue:** src/cli/mod.rs only contains 'pub mod commands;' with no clap setup\n\n**Why it matters:**\n- Cannot run any commands without CLI parsing\n- Spec requires detect, deps, audit, quality, unused, unsafe, tree subcommands\n- Global flags --verbose, --json, --log-level not implemented\n- 'cargo upkeep' invocation pattern not handled\n\n**Fix:**\nImplement in src/cli/mod.rs:\n```rust\nuse clap::{Parser, Subcommand};\n\npub mod commands;\n\n/// Cargo subcommand wrapper (handles 'cargo upkeep' invocation)\n#[derive(Parser)]\n#[command(name = \"cargo\")]\n#[command(bin_name = \"cargo\")]\npub struct Cargo {\n    #[command(subcommand)]\n    pub command: CargoCommands,\n}\n\n#[derive(Subcommand)]\npub enum CargoCommands {\n    /// Unified Rust project maintenance CLI\n    Upkeep(UpkeepArgs),\n}\n\n#[derive(clap::Args)]\npub struct UpkeepArgs {\n    #[command(subcommand)]\n    pub command: Commands,\n    \n    /// Enable verbose output (info level logging)\n    #[arg(long, global = true)]\n    pub verbose: bool,\n    \n    /// Set log level (trace, debug, info, warn, error)\n    #[arg(long, global = true)]\n    pub log_level: Option\u003cString\u003e,\n    \n    /// Output as JSON\n    #[arg(long, global = true)]\n    pub json: bool,\n}\n\n#[derive(Subcommand)]\npub enum Commands {\n    /// Detect project configuration\n    Detect,\n    /// Check for outdated dependencies\n    Deps,\n    /// Run security audit\n    Audit,\n    /// Generate quality score\n    Quality,\n    /// Find unused dependencies\n    Unused,\n    /// Report unsafe code usage\n    Unsafe,\n    /// Show dependency tree\n    Tree,\n}\n```\n\n**Files to modify:**\n- src/cli/mod.rs\n\n**Acceptance:** cargo run -- upkeep --help shows all subcommands and flags","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:23:50.359302-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:50.986551-06:00","closed_at":"2026-02-04T07:28:50.986551-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-a3h","title":"BUG: Double-counting errors when clippy fails","description":"In clippy.rs lines 104-113, when cargo clippy exits with non-zero status, errors are double-counted.\n\nWhen clippy fails due to deny lints or compilation errors, those errors are already counted in the parsing loop (lines 82-87). Adding another errors += 1 here double-counts them.\n\nImpact: Score calculation will be incorrect (penalized 10 extra points for the same error).\n\nFix: Only add the synthetic error if no actual errors were parsed, or track whether the failure was due to a clippy lint vs a compilation issue.\n\n```rust\n// Current (buggy):\nif clippy_failed {\n    errors += 1;  // This adds +1 to errors\n    details.push(ClippyIssue { ... });\n}\n\n// Fix option 1: Only add if no errors parsed\nif clippy_failed \u0026\u0026 errors == 0 {\n    errors += 1;\n    details.push(ClippyIssue { ... });\n}\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T17:45:21.557437-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T17:52:23.417958-06:00","closed_at":"2026-02-04T17:52:23.417958-06:00","close_reason":"Fixed: conditional synthetic error, added allow(dead_code), standardized score calculation with saturating_sub, use total_cmp for float sorting"}
{"id":"upkeep-rs-aod","title":"Standardize error message formatting","description":"In src/core/error.rs, error messages are inconsistent: some lowercase, some reference tools directly, some include suggestions. Establish style guide: all lowercase, suggestions separated, include failing operation in context.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:45.408297-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.454182-06:00","closed_at":"2026-02-04T21:53:48.454182-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-b1r","title":"Remove module-level dead_code allow in crates_io.rs","description":"In src/core/analyzers/crates_io.rs:1, #![allow(dead_code)] suppresses all warnings. Remove and add targeted #[allow(dead_code)] with comments on specific items, or use the unused items.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:33.167736-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.392758-06:00","closed_at":"2026-02-04T21:53:48.392758-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-b79","title":"Document magic numbers in quality scorer","description":"In src/core/scorers/quality.rs:127-157, magic numbers like 25, 15, 10, 5 for penalty multipliers are undocumented. Extract to named constants with comments explaining rationale (e.g., CRITICAL_VULN_PENALTY = 25).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:37:06.638555-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.161224-06:00","closed_at":"2026-02-04T22:48:50.161224-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-bbo","title":"Create install.sh script for binary distribution","description":"Create scripts/install.sh for easy installation:\n\n1. Platform detection:\n   OS=$(uname -s | tr '[:upper:]' '[:lower:]')\n   ARCH=$(uname -m)\n   Map to: x86_64-unknown-linux-gnu, aarch64-apple-darwin, etc.\n\n2. Download binary from GitHub releases:\n   PLATFORM=$(detect_platform)\n   VERSION=${VERSION:-latest}\n   URL='https://github.com/llbbl/cargo-upkeep/releases/${VERSION}/download/cargo-upkeep-${PLATFORM}'\n   curl -fsSL '$URL' -o cargo-upkeep\n   chmod +x cargo-upkeep\n\n3. Install to appropriate location:\n   - Check for ~/.cargo/bin (preferred for Rust tools)\n   - Fallback to /usr/local/bin\n   - Support INSTALL_DIR environment variable\n\n4. Verify installation:\n   cargo-upkeep --version\n\n5. Error handling with helpful messages\n6. Support --help flag for usage info\n\nReference TS: Similar pattern to bun/node install scripts\n\nAcceptance: curl -fsSL .../install.sh | bash installs working binary","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:12.681585-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.338315-06:00","closed_at":"2026-02-05T13:28:51.338315-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-bcf","title":"BUG: Inconsistent score calculation approaches between clippy and quality","description":"The clippy analyzer and quality scorer use different approaches to calculate scores:\n\nclippy.rs line 115:\n```rust\nlet score = (100_i32 - (warnings as i32 * 2) - (errors as i32 * 10)).max(0) as f32;\n```\n\nquality.rs line 114:\n```rust\n100u64.saturating_sub(penalty) as f32\n```\n\nThe clippy analyzer uses i32 math with .max(0), while quality scorer uses u64 with saturating_sub. Both work but should be consistent for maintainability.\n\nFix: Standardize on one approach. The saturating_sub approach is cleaner:\n```rust\nlet penalty = (warnings as u64 * 2) + (errors as u64 * 10);\nlet score = 100u64.saturating_sub(penalty) as f32;\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T17:45:23.280851-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T17:52:23.477935-06:00","closed_at":"2026-02-04T17:52:23.477935-06:00","close_reason":"Fixed: conditional synthetic error, added allow(dead_code), standardized score calculation with saturating_sub, use total_cmp for float sorting"}
{"id":"upkeep-rs-bco","title":"Unsafe: detect unparsed schema","description":"Review feedback: parse_geiger_packages drops entries without name, potentially masking schema drift. Consider erroring when zero packages parsed or required identifiers missing.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T19:19:08.19194-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T19:20:45.463365-06:00","closed_at":"2026-02-04T19:20:45.463365-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ben","title":"Add recursion depth limit in tree.rs build_node","description":"In src/cli/commands/tree.rs lines 230-328, while cycle detection exists, recursion depth is limited only by graph depth, not stack size. For extremely deep graphs this could cause stack overflow. Add internal max depth limit (e.g., 1000) or convert to iterative approach.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:24:08.01108-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.665582-06:00","closed_at":"2026-02-04T21:15:15.665582-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-bg2","title":"Reduce MAX_TREE_DEPTH to prevent stack overflow","description":"In src/cli/commands/tree.rs:9, MAX_TREE_DEPTH=1000 may still cause stack overflow on systems with smaller stacks. Consider reducing to 100-200 or converting to iterative traversal with explicit stack.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:27:37.997217-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.42165-06:00","closed_at":"2026-02-04T22:33:21.42165-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-bjl","title":"BUG: Missing error context for spawn_blocking JoinError","description":"In audit.rs the JoinError from spawn_blocking indicates the task either panicked or was cancelled. The current error message 'audit task failed' loses information about which case occurred.\n\nLocation: src/cli/commands/audit.rs lines 7-9\n\nCurrent code:\n```rust\nlet output = tokio::task::spawn_blocking(run_audit)\n    .await\n    .context(\"audit task failed\")??;\n```\n\nFix:\n```rust\nlet output = tokio::task::spawn_blocking(run_audit)\n    .await\n    .map_err(|e| {\n        if e.is_panic() {\n            anyhow::anyhow\\!(\"audit task panicked: {e}\")\n        } else {\n            anyhow::anyhow\\!(\"audit task cancelled: {e}\")\n        }\n    })??;\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T12:30:32.723978-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:08:35.026216-06:00","closed_at":"2026-02-04T14:08:35.026216-06:00","close_reason":"Fixed: removed crates-index (using direct API), added fallback source matching in path_to, improved JoinError handling"}
{"id":"upkeep-rs-bnn","title":"Create upkeep-audit Claude Code skill","description":"Create skills/upkeep-audit/SKILL.md for security scanning:\n\n1. Skill metadata:\n   # /upkeep-audit - Rust Security Scanner\n   Trigger: User asks about security vulnerabilities or wants to audit\n\n2. Workflow:\n   - Run cargo upkeep audit to scan for vulnerabilities\n   - For each vulnerability:\n     - Explain the issue in plain terms\n     - Check if patched version available\n     - Guide through fix:\n       - If patch exists: Update to patched version\n       - If no patch: Suggest alternatives\n       - Run tests to verify fix\n\n3. Severity handling:\n   - Critical: Immediate action required\n   - High: Should fix soon\n   - Moderate: Plan to fix\n   - Low: Informational\n\n4. Provide links to RustSec advisories\n\n5. Git workflow:\n   - Create security fix branch\n   - Commit with security fix message\n   - Create PR with vulnerability details\n\nReference TS: skills/upkeep-audit/ in upkeep repo\n\nAcceptance: Skill file complete with vulnerability handling workflow","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:31.084722-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.665653-06:00","closed_at":"2026-02-05T13:28:51.665653-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-btex","title":"Handle virtual workspaces gracefully in quality check_msrv","description":"In quality.rs:171-176, check_msrv returns error for virtual workspaces. Should return MsrvStatus::Missing for graceful degradation instead of error that implies a bug.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-05T13:03:34.20983-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.529612-06:00","closed_at":"2026-02-05T13:07:58.529612-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-bux","title":"Unsafe: surface stderr on geiger failure","description":"Review feedback: if cargo geiger exits non-zero but stdout isn't valid JSON, the analyzer reports InvalidData without stderr. Update run_geiger_json/run_geiger_json_alt to include stderr in ExternalCommand error when JSON parse fails.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T19:19:08.085203-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T19:20:45.257641-06:00","closed_at":"2026-02-04T19:20:45.257641-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-c1o","title":"Add README with project overview","description":"Create README.md with short project description, basic usage placeholder, and development setup notes.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:15:05.964162-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:17:21.443251-06:00","closed_at":"2026-02-04T07:17:21.443251-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-cl4","title":"Log warning when cwd cannot be determined","description":"In src/cli/commands/tree.rs:32-34, current_dir() error is silently swallowed with unwrap_or_else. Log a tracing warning since this may indicate a deeper problem (e.g., cwd was deleted).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:31.295454-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.1286-06:00","closed_at":"2026-02-04T21:53:48.1286-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-clj","title":"Add error context to HTTP requests in crates_io.rs","description":"HTTP errors don't include which crate failed to fetch.\n\n**File:** src/core/analyzers/crates_io.rs lines 127-128\n\n**Current code:**\n```rust\nlet response = self.http.get(url).send().await?;\nlet payload: CratesIoResponse = response.error_for_status()?.json().await?;\n```\n\n**Why it matters:** If crate lookup fails (404, timeout, etc.), user won't know which dependency caused failure. Debugging impossible.\n\n**Fix:**\n```rust\nuse anyhow::Context;\n\nlet response = self.http.get(\u0026url).send().await\n    .with_context(|| format\\!(\"failed to fetch crate info for '{}'\", name))?;\nlet payload: CratesIoResponse = response\n    .error_for_status()\n    .with_context(|| format\\!(\"crates.io API error for '{}'\", name))?\n    .json()\n    .await\n    .with_context(|| format\\!(\"failed to parse crates.io response for '{}'\", name))?;\n```\n\n**Acceptance:** HTTP errors include crate name in error message","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T11:42:45.356361-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:10:53.680773-06:00","closed_at":"2026-02-04T12:10:53.680773-06:00","close_reason":"Fixed all three P1 bugs: added catch-all for DependencyKind::Unknown, changed is_stable to return false on parse failure, and added error context to HTTP requests"}
{"id":"upkeep-rs-cno","title":"Audit: adjust severity default","description":"Review feedback: map unknown RustSec severity to a clearer default (consider low or explicit unscored) instead of moderate, and document if needed.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T12:24:01.130966-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:26:19.876315-06:00","closed_at":"2026-02-04T12:26:19.876315-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-cr5q","title":"Expand output display tests","description":"Target: src/core/output.rs\n\nAdd tests to cover Display implementations (not just serialization):\n- DetectOutput/DepsOutput/AuditOutput/QualityOutput/UnusedOutput/UnsafeOutput/TreeOutput formatting.\n- Ensure sections appear conditionally (warnings, security, skipped members).\n- Ensure pluralization/empty cases output \"none\" or empty lists consistently.\n\nUse small fixtures and string contains assertions for key lines.","acceptance_criteria":"- Display formatting paths are covered for each output struct.\n- Conditional sections (warnings/security/empty) are asserted.\n- cargo test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-05T09:12:06.758829-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:26:02.857239-06:00","closed_at":"2026-02-05T09:26:02.857239-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-cxk","title":"Fix clippy map_or warning in detect.rs test","description":"In tests/detect.rs:85-87, use of map_or where is_some_and is more idiomatic. Change .map_or(false, |members| !members.is_empty()) to .is_some_and(|members| !members.is_empty()).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:37:05.2374-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.06764-06:00","closed_at":"2026-02-04T22:48:50.06764-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-cy6","title":"Extract shared error handling in unsafe_code.rs","description":"In src/core/analyzers/unsafe_code.rs lines 51-109, run_geiger_json and run_geiger_json_alt share nearly identical error handling logic. Extract common error handling into a shared helper function like handle_geiger_output() to reduce duplication.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:23:54.891581-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.69791-06:00","closed_at":"2026-02-04T21:15:15.69791-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-d6te","title":"Add skip message when external tool tests are skipped","description":"In tests/cli.rs:143-171, cli_unused_command and cli_unsafe_command tests silently return when cargo-machete/geiger not installed. Add eprintln\\! skip message so it's clear the test was skipped, not passed.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T23:26:44.591545-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:12.92374-06:00","closed_at":"2026-02-04T23:31:12.92374-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-d8dc","title":"Deduplicate CLI run_with helpers","description":"Target: src/cli/commands/audit.rs, src/cli/commands/unused.rs, src/cli/commands/unsafe_code.rs\n\nrun_with helper pattern is duplicated. Introduce a shared helper (module-private) to route JSON/text printing and error propagation. Ensure behavior and tests remain unchanged.","acceptance_criteria":"- Shared helper reduces duplication without changing output behavior.\n- Existing tests updated as needed.\n- cargo test passes.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T10:07:06.002243-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:13:28.102782-06:00","closed_at":"2026-02-05T10:13:28.102782-06:00","close_reason":"Closed","labels":["refactor"]}
{"id":"upkeep-rs-dq7","title":"Implement deps command - outdated dependency analysis with semver","description":"Create src/cli/commands/deps.rs for dependency analysis:\n\n1. Parse Cargo.toml and Cargo.lock using cargo_metadata\n\n2. For each dependency determine:\n   - Current version (from Cargo.lock resolved)\n   - Required version range (from Cargo.toml)\n   - Latest version (from crates.io)\n\n3. Classify updates using semver crate:\n   fn classify_update(current: \u0026Version, latest: \u0026Version) -\u003e UpdateType\n\n4. Separate dependencies by type:\n   - Normal dependencies\n   - Dev dependencies\n   - Build dependencies\n\n5. Build DepsOutput:\n   { total, outdated, major, minor, patch, packages: Vec\u003cOutdatedPackage\u003e }\n\n6. Add --security flag to include audit results in parallel\n\nReference TS: src/cli/commands/deps.ts, src/lib/analyzers/deps.ts\n\nAcceptance: cargo run -- deps outputs JSON with outdated dependencies","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:49.092381-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:18:32.167414-06:00","closed_at":"2026-02-04T22:18:32.167414-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-dsnv","title":"Make cli_audit_command path assertion more resilient","description":"In tests/cli.rs:126-141, audit test constructs path and compares to stderr. Could fail with path separator differences. Use more resilient substring checks.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:32:55.468006-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:37:03.569274-06:00","closed_at":"2026-02-05T09:37:03.569274-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-dvjs","title":"Document optional test tooling installs","description":"Target: README.md\n\nAdd explicit commands to install optional tooling for full coverage:\n- cargo install cargo-machete\n- cargo install cargo-geiger\n\nClarify httpmock is a dev dependency only.","acceptance_criteria":"- README lists install commands for cargo-machete and cargo-geiger.\n- Notes that httpmock is dev-only.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T13:28:04.40378-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:52.093573-06:00","closed_at":"2026-02-05T13:28:52.093573-06:00","close_reason":"Closed","labels":["docs"]}
{"id":"upkeep-rs-dwv","title":"Add integration tests for command execution","description":"Integration tests verify help/version flags but don't test actual command execution.\n\n**File:** tests/cli.rs\n\n**Why it matters:** Running 'cargo upkeep detect' should be tested even if it's a stub.\n\n**Fix:**\nAdd command execution tests:\n```rust\n#[test]\nfn cli_detect_command_runs() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"detect\"])\n        .assert()\n        .failure()  // Expect failure for unimplemented\n        .stderr(predicate::str::contains(\"not yet implemented\"));\n}\n\n#[test]\nfn cli_audit_command_runs() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"audit\"])\n        .assert()\n        .failure()\n        .stderr(predicate::str::contains(\"not yet implemented\"));\n}\n\n#[test]\nfn cli_deps_command_runs() {\n    let mut cmd = Command::cargo_bin(\"cargo-upkeep\").unwrap();\n    cmd.args([\"upkeep\", \"deps\"])\n        .assert()\n        .failure()\n        .stderr(predicate::str::contains(\"not yet implemented\"));\n}\n\n// Add for quality, unused, unsafe, tree\n```\n\n**Acceptance:** Each subcommand has integration test coverage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:50.612141-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:17:08.036413-06:00","closed_at":"2026-02-04T23:17:08.036413-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-e6m","title":"Implement clippy analyzer for warning/error counting","description":"Create src/lib/analyzers/clippy.rs to run and parse clippy output:\n\n1. Execute clippy with JSON message format:\n   cargo clippy --message-format=json --all-targets --all-features\n\n2. Parse JSON output (one JSON object per line):\n   CargoMessage { reason, message: Option\u003cDiagnosticMessage\u003e }\n   DiagnosticMessage { level, code, message, spans }\n\n3. Count warnings and errors by category:\n   ClippyOutput {\n     warnings: usize,\n     errors: usize,\n     warnings_by_lint: HashMap\u003cString, usize\u003e,\n     details: Vec\u003cClippyIssue\u003e,\n   }\n\n4. Extract lint names from diagnostic codes (e.g., 'clippy::unwrap_used')\n5. Calculate score: max(0, 100 - (warnings * 2) - (errors * 10))\n6. Handle case where clippy not installed\n\nReference TS: No direct equivalent, this is Rust-specific\n\nAcceptance: Clippy analyzer accurately counts warnings/errors and calculates score","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:14.973906-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:19:35.660837-06:00","closed_at":"2026-02-04T14:19:35.660837-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-e7q","title":"Document or optimize rate limiting behavior","description":"In src/core/analyzers/crates_io.rs:69-74, rate limiting sleeps after acquiring semaphore, resulting in ~2+ seconds between requests (more conservative than 1/sec). Also sequential fetching means 50 deps takes 50+ seconds. Document or optimize.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T22:27:39.335377-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.982058-06:00","closed_at":"2026-02-05T12:58:20.982058-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-e83","title":"Update README with actual CLI usage and examples","description":"README is minimal and doesn't reflect actual CLI usage.\n\n**Issue:** README.md lacks command documentation\n\n**Missing content:**\n- Available commands list\n- Flag options (--verbose, --json, --log-level)\n- Example outputs\n- Installation instructions\n\n**Why it matters:** Users can't understand how to use the tool without reading source code.\n\n**Fix:**\n```markdown\n# cargo-upkeep\n\nUnified Rust project maintenance CLI - one tool for dependency updates, security audits, and code quality.\n\n## Installation\n\n\\`\\`\\`bash\ncargo install cargo-upkeep\n\\`\\`\\`\n\n## Commands\n\n\\`\\`\\`bash\ncargo upkeep detect   # Detect project configuration\ncargo upkeep deps     # Check for outdated dependencies  \ncargo upkeep audit    # Security vulnerability scan\ncargo upkeep quality  # Generate health score (A-F grade)\ncargo upkeep unused   # Find unused dependencies\ncargo upkeep unsafe   # Report unsafe code usage\ncargo upkeep tree     # Enhanced dependency tree\n\\`\\`\\`\n\n## Global Flags\n\n- \\`--verbose\\`, \\`-v\\`: Enable info-level logging\n- \\`--json\\`: Output results as JSON\n- \\`--log-level=\u003clevel\u003e\\`: Set log level (trace/debug/info/warn/error)\n\n## Examples\n\n\\`\\`\\`bash\n# Check for outdated dependencies\ncargo upkeep deps\n\n# Run security audit with verbose output\ncargo upkeep --verbose audit\n\n# Get quality report as JSON\ncargo upkeep --json quality\n\\`\\`\\`\n```\n\n**Files to modify:**\n- README.md\n\n**Acceptance:** README documents all commands and flags with examples","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:33:14.00163-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.336672-06:00","closed_at":"2026-02-04T07:45:42.336672-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-e9b","title":"Remove unnecessary async from detect::run","description":"Function marked async but contains no .await calls.\n\n**File:** src/cli/commands/detect.rs line 8\n\n**Issue:**\n```rust\npub async fn run(json: bool) -\u003e Result\u003c()\u003e {\n    let metadata = MetadataCommand::new().exec()?;  // synchronous\n    // ...\n}\n```\n\nMetadataCommand::exec() and all file system access are synchronous.\n\n**Why it matters:** Misleading and adds unnecessary overhead. Async machinery adds cognitive load.\n\n**Fix:** Either remove async or add comment explaining it's for future-proofing:\n```rust\npub fn run(json: bool) -\u003e Result\u003c()\u003e {\n```\n\n**Acceptance:** Function is sync, or has comment explaining why async","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:04:32.42534-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:33:32.915032-06:00","closed_at":"2026-02-04T21:33:32.915032-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-eb9","title":"Implement tree command - enhanced dependency tree visualization","description":"Create src/cli/commands/tree.rs for dependency visualization:\n\n1. Use cargo_metadata to build dependency graph:\n   let metadata = MetadataCommand::new().features(AllFeatures).exec()?;\n   let resolve = metadata.resolve.unwrap();\n\n2. Build tree structure:\n   DepNode {\n     name: String,\n     version: String,\n     features: Vec\u003cString\u003e,\n     children: Vec\u003cDepNode\u003e,\n     is_dev: bool,\n     is_build: bool,\n   }\n\n3. Enhancements beyond cargo-tree:\n   - Highlight outdated dependencies\n   - Show security vulnerabilities inline\n   - Display feature flags used\n   - Mark duplicate versions\n\n4. Support flags:\n   --depth \u003cn\u003e: Limit tree depth\n   --duplicates: Only show crates with multiple versions\n   --invert \u003ccrate\u003e: Show reverse dependencies\n   --features: Show feature flags\n   --no-dev: Exclude dev dependencies\n\n5. JSON output:\n   TreeOutput { root: DepNode, stats: TreeStats }\n   TreeStats { total_crates, direct_deps, transitive_deps, duplicate_crates }\n\nAcceptance: cargo run -- tree displays dependency tree with annotations","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:35.263252-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:13:01.318976-06:00","closed_at":"2026-02-04T18:13:01.318976-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ed0","title":"Create upkeep-quality Claude Code skill","description":"Create skills/upkeep-quality/SKILL.md for health reporting:\n\n1. Skill metadata:\n   # /upkeep-quality - Rust Project Health Report\n   Trigger: User asks about project health or quality assessment\n\n2. Workflow:\n   - Run cargo upkeep quality to get health report\n   - Present grade (A-F) with breakdown\n   - For each low-scoring metric, suggest improvements:\n     - Dependencies: Run /upkeep-deps\n     - Security: Run /upkeep-audit\n     - Clippy: Fix warnings\n     - MSRV: Add rust-version to Cargo.toml\n     - Unused deps: Remove with cargo-machete\n     - Unsafe code: Audit and document\n\n3. Track progress:\n   - Compare with previous runs if available\n   - Celebrate improvements\n   - Identify regressions\n\n4. Prioritized recommendations:\n   - High: Security, critical updates\n   - Medium: Code quality, test coverage\n   - Low: Style, documentation\n\n5. Generate action plan for improving score\n\nReference TS: skills/upkeep-quality/ in upkeep repo\n\nAcceptance: Skill file complete with improvement guidance workflow","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:31.330791-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.773623-06:00","closed_at":"2026-02-05T13:28:51.773623-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-emyp","title":"Add PartialEq derive to DependencyType for cleaner test assertions","description":"In src/core/analyzers/unused.rs:353-360, tests use matches\\!() macro for enum comparison. If DependencyType derives PartialEq, tests can use simpler assert_eq\\!(). DependencyType has Copy but not PartialEq.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T23:26:37.288403-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:12.985122-06:00","closed_at":"2026-02-04T23:31:12.985122-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-eo8a","title":"Add tree command coverage for filters","description":"Target: src/cli/commands/tree.rs\n\nAdd tests for tree rendering and filters:\n- depth limiting and duplicate-only filtering behavior.\n- invert mode with specific crate name.\n- no-dev exclusion handling.\n- JSON output structure matches TreeOutput for a small fixture workspace.\n\nUse a temp workspace with 2-3 crates + dependencies to validate counts.","acceptance_criteria":"- Tests cover depth/duplicate/invert/no-dev behaviors.\n- JSON output structure asserts root/stats.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:12:06.764233-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:26:02.743535-06:00","closed_at":"2026-02-05T09:26:02.743535-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-etf6","title":"Add output serialization unit tests","description":"Target: src/core/output.rs\n\nAdd unit tests to validate JSON serialization for key output types:\n- AuditOutput, DepsOutput (including warnings/security fields), QualityOutput, DetectOutput, UnusedOutput, UnsafeOutput, TreeOutput.\n- Enum serialization (Grade, Severity, UpdateType, Confidence, DependencyType).\n- ErrorOutput shape for UpkeepError (code/message/context).\n\nPrefer snapshot-style JSON assertions with serde_json::to_value and explicit field checks.","acceptance_criteria":"- Tests cover serialization of major output structs and enums.\n- Error output JSON shape is asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:54:02.887718-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:59:45.777578-06:00","closed_at":"2026-02-04T22:59:45.777578-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-f577","title":"Align install.sh with release artifacts","description":"Problem: scripts/install.sh downloads raw binaries (cargo-upkeep-{target}), but release workflow publishes only archives (.tar.gz/.zip). This will 404 for tagged releases.\n\nFix: Either update install.sh to download archives and extract the binary, or update release workflow to publish raw binaries alongside archives. Prefer updating install.sh for consistency.\n\nAcceptance:\n- install.sh works with current release artifacts.\n- README install script example still valid.","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-05T13:29:33.455099-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:29:33.455099-06:00","labels":["docs","release"]}
{"id":"upkeep-rs-f7m","title":"BUG: Source format mismatch in DependencyGraph::path_to may cause incorrect paths","description":"In audit.rs DependencyGraph::path_to(), the source field from rustsec's Package may not match the format used by cargo_metadata. The rustsec source is derived from the lockfile while cargo_metadata uses its own representation.\n\nThis mismatch could cause path_to to always return None for crates.io packages, resulting in the fallback single-element path instead of the full dependency chain.\n\nLocation: src/core/analyzers/audit.rs lines 133-140\n\nImpact: The dependency path shown to users may be incomplete/incorrect.\n\nRecommendation: \n- Verify the source format alignment\n- Consider matching only on (name, version) when source is None or represents crates.io\n- Add tests to verify path resolution works correctly","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T12:30:32.286878-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:08:34.996664-06:00","closed_at":"2026-02-04T14:08:34.996664-06:00","close_reason":"Fixed: removed crates-index (using direct API), added fallback source matching in path_to, improved JoinError handling"}
{"id":"upkeep-rs-fja","title":"Add integration tests with real Cargo projects","description":"Create integration tests that run against real Cargo projects:\n\n1. Create test fixtures:\n   tests/fixtures/\n   ├── simple-project/\n   │   ├── Cargo.toml\n   │   ├── Cargo.lock\n   │   └── src/main.rs\n   ├── workspace-project/\n   │   ├── Cargo.toml\n   │   ├── member-a/\n   │   └── member-b/\n   └── vulnerable-project/\n       ├── Cargo.toml (with old deps)\n       └── Cargo.lock\n\n2. Integration tests for each command:\n   - Test detect with simple/workspace/library projects\n   - Test deps output format\n   - Test audit with known vulnerable deps\n   - Test quality score calculation\n   - Test tree output\n\n3. Test scenarios:\n   - Simple binary project\n   - Library project\n   - Workspace with multiple members\n   - Project with outdated dependencies\n   - Project with known vulnerabilities\n   - Project with clippy warnings\n\n4. Test JSON output validity\n5. Test error cases (non-Cargo dir, malformed Cargo.toml)\n\nAcceptance: Integration tests validate end-to-end command behavior","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:08:54.092523-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:47.856346-06:00","closed_at":"2026-02-04T21:21:47.856346-06:00","close_reason":"DONE: tests/detect.rs creates temp Cargo projects and runs detect"}
{"id":"upkeep-rs-fmk","title":"Implement JSON output module with structured types","description":"Added structured JSON output types and helpers in src/core/output.rs with serde serialization and Display implementations.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:15.217315-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T08:55:59.594896-06:00","closed_at":"2026-02-04T08:55:59.594896-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-fqh","title":"Document Clone strategy for UpkeepError","description":"In src/core/error.rs line 29, UpkeepError cannot be cloned because it contains Box\u003cdyn StdError + Send + Sync\u003e. Either use Arc\u003cdyn Error\u003e if cloning is needed, or add documentation explaining errors are not clonable by design.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:07.739776-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.922651-06:00","closed_at":"2026-02-04T21:15:15.922651-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ftm","title":"Deps: partial output on crates.io failure","description":"Review feedback: deps::analyze currently fails hard if crates.io fetch fails. Consider best-effort output with a warning/recommendation when crates.io is unavailable, similar to quality's partial failure handling.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T21:28:00.986182-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:33:32.69406-06:00","closed_at":"2026-02-04T21:33:32.69406-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-fxff","title":"Deduplicate dependencies across workspace members in deps.rs","description":"In deps.rs:189-224, partition_dependencies collects deps from all workspace members. If two members depend on same crate at same version, it's processed twice and may appear multiple times in output, inflating total_dependencies count. Deduplicate by (name, alias, version) tuple.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-05T13:03:34.095525-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.496-06:00","closed_at":"2026-02-05T13:07:58.496-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-g0e","title":"Clippy: handle non-zero exit","description":"Review feedback: clippy analyzer returns 100 score when cargo clippy fails but outputs no clippy:: messages. Handle non-success exit by returning error or explicitly marking failure (score 0 + recommendation).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T14:16:40.891916-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:18:05.603982-06:00","closed_at":"2026-02-04T14:18:05.603982-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-gd0k","title":"Tighten cli_without_args exit code assertion","description":"In tests/cli.rs:34-48, test accepts exit codes 0 or 2 but arg_required_else_help should always exit 2. Tighten to expect only code 2.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T10:22:55.87865-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:45:47.976727-06:00","closed_at":"2026-02-05T12:45:47.976727-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-gfhe","title":"Add audit CLI command tests","description":"Target: src/cli/commands/audit.rs\n\nAdd unit/integration coverage for audit command handler:\n- Verify JSON output path with a mocked rustsec database (or a fixture).\n- Verify MissingLockfile/Metadata errors map to ErrorCode::InvalidData.\n- Verify non-JSON output path prints summary with counts.\n\nPrefer a test seam to inject audit output without hitting the network.","acceptance_criteria":"- Tests cover success and error paths.\n- JSON and text output are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:12:06.752778-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:26:02.630717-06:00","closed_at":"2026-02-05T09:26:02.630717-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-h4z","title":"Add thiserror dependency for typed errors","description":"CLAUDE.md lists thiserror as key dependency but it's not included.\n\n**File:** Cargo.toml\n\n**Why it matters:** anyhow is great for application errors, but thiserror is needed for library-style typed errors that callers can match on.\n\n**Fix:**\n1. Add to Cargo.toml:\n```toml\nthiserror = \"1.0\"\n```\n\n2. Define error types in src/core/mod.rs or src/core/error.rs:\n```rust\nuse thiserror::Error;\n\n#[derive(Debug, Error)]\npub enum UpkeepError {\n    #[error(\"failed to parse Cargo.toml: {0}\")]\n    CargoTomlParse(String),\n    \n    #[error(\"failed to fetch crates.io data: {0}\")]\n    CratesIoFetch(String),\n    \n    #[error(\"RustSec database error: {0}\")]\n    RustSecError(String),\n    \n    #[error(\"command not yet implemented: {0}\")]\n    NotImplemented(String),\n}\n```\n\n**Acceptance:** Typed errors defined with thiserror, used in command handlers","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:51.058061-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:46.214613-06:00","closed_at":"2026-02-04T21:21:46.214613-06:00","close_reason":"DONE: thiserror 1.0 in Cargo.toml, used in error.rs"}
{"id":"upkeep-rs-h8s","title":"Add kind field to OutdatedPackage struct","description":"OutdatedPackage struct doesn't indicate dependency type.\n\n**File:** src/core/output.rs lines 64-69\n\n**Issue:** No field indicating whether dependency is normal, dev, or build.\n\n**Why it matters:** Users often want to prioritize normal dependencies over dev dependencies for updates.\n\n**Fix:**\n```rust\npub struct OutdatedPackage {\n    pub name: String,\n    pub current: String,\n    pub latest: String,\n    pub update_type: UpdateType,\n    pub kind: DependencyKind,  // Add enum: Normal, Dev, Build\n}\n```\n\n**Acceptance:** OutdatedPackage includes dependency kind","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:04:33.39441-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:37.819282-06:00","closed_at":"2026-02-04T21:21:37.819282-06:00","close_reason":"DONE: dependency_type field exists distinguishing Normal/Dev/Build"}
{"id":"upkeep-rs-hbjm","title":"Document httpmock dev-dependency usage","description":"httpmock was added to Cargo.toml dev-dependencies but not documented. Add note to CLAUDE.md or README about test dependencies and how to run tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T23:26:44.815278-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:21.090302-06:00","closed_at":"2026-02-05T12:58:21.090302-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-hbx","title":"Implement quality command with parallel analyzer execution","description":"Create src/cli/commands/quality.rs that orchestrates all analyzers:\n\n1. Run all analyzers in parallel using tokio::join!:\n   let (deps, audit, clippy, msrv) = tokio::join!(\n     analyze_deps(path),\n     analyze_audit(path),\n     analyze_clippy(path),\n     check_msrv(path),\n   );\n\n2. Collect metrics from each analyzer:\n   QualityMetrics {\n     dependency_freshness: MetricResult,\n     security: MetricResult,\n     unused_deps: MetricResult,\n     unsafe_code: MetricResult,\n     clippy: MetricResult,\n     msrv: MetricResult,\n   }\n\n3. Pass metrics to quality scorer\n4. Build QualityOutput:\n   { score: u8, grade: Grade, breakdown: HashMap, recommendations: Vec }\n\n5. Generate recommendations with priority:\n   - High: Security issues, critical outdated deps\n   - Medium: Minor updates, coverage gaps\n   - Low: MSRV, clippy suggestions\n\n6. Handle partial failures gracefully\n\nReference TS: src/cli/commands/quality.ts\n\nAcceptance: cargo run -- quality produces health report with grade","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:17.877611-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:33:32.807864-06:00","closed_at":"2026-02-04T21:33:32.807864-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-her","title":"Include path in MAX_TREE_DEPTH error message","description":"In src/cli/commands/tree.rs:221-229, when MAX_TREE_DEPTH is exceeded, error message mentions circular dependency but doesn't include path information to help debug. Include current dependency path in error.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:19.101959-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.099016-06:00","closed_at":"2026-02-04T21:53:48.099016-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-i3y","title":"Implement unsafe code command - unsafe usage reporting","description":"Create src/cli/commands/unsafe_code.rs for unsafe analysis (Phase 2):\n\n1. Approach options:\n   - Option A: Shell out to cargo-geiger (feature-rich)\n   - Option B: Basic AST scanning with syn crate\n   - Option C: Use rustc MIR analysis\n\n2. For MVP (Option A):\n   cargo geiger --output-format json\n   Parse for unsafe counts\n\n3. For custom implementation:\n   struct UnsafeCounter {\n     unsafe_blocks: usize,\n     unsafe_fns: usize,\n     unsafe_traits: usize,\n     unsafe_impls: usize,\n   }\n\n4. Output structure:\n   UnsafeOutput {\n     summary: UnsafeSummary,\n     by_crate: Vec\u003cCrateUnsafe\u003e,\n     your_code: UnsafeStats,\n     dependencies: UnsafeStats,\n   }\n\n5. Distinguish between:\n   - Unsafe in your code (controllable)\n   - Unsafe in dependencies (informational)\n   - Required unsafe (FFI, etc.)\n\n6. Calculate safety score based on ratio\n\nAcceptance: cargo run -- unsafe reports unsafe code usage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:35.758687-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T19:20:45.577963-06:00","closed_at":"2026-02-04T19:20:45.577963-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-i4cz","title":"Fix silent test skips in audit.rs dependency_graph test","description":"In audit.rs:298-346, test conditionally skips with eprintln. CI could pass while paths untested. Use #[ignore] with reason or create test fixtures.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T10:22:56.093686-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:45:48.037229-06:00","closed_at":"2026-02-05T12:45:48.037229-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-i9s","title":"Document error variant usage patterns","description":"In src/core/error.rs lines 30-56, UpkeepError::Message and UpkeepError::Context overlap with #[from] variants. An I/O error could be represented multiple ways. Document when to use each pattern: #[from] at API boundaries, Context for domain-specific context, avoid Message for errors with sources.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:17.453442-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.953937-06:00","closed_at":"2026-02-04T21:15:15.953937-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ibu","title":"Quality: avoid score overflow","description":"Review feedback: security/clippy score computations use usize multiplications then cast to i32, which can overflow. Use i64/u64 with saturating math, then clamp.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T14:16:40.993648-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:18:05.825423-06:00","closed_at":"2026-02-04T14:18:05.825423-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ih4","title":"Add missing unsafe and tree commands to CLI","description":"The UpkeepCommand enum is missing two commands specified in the spec.\n\n**Issue:** src/cli/mod.rs lines 39-46 - Only 5 of 7 spec commands implemented\n\n**Current:**\n```rust\n#[derive(Debug, Subcommand)]\npub enum UpkeepCommand {\n    Detect,\n    Audit,\n    Deps,\n    Quality,\n    Unused,\n}\n```\n\n**Missing:**\n- `Unsafe` - Unsafe code report (cargo upkeep unsafe)\n- `Tree` - Enhanced dependency tree (cargo upkeep tree)\n\n**Why it matters:** Users expecting 'cargo upkeep unsafe' or 'cargo upkeep tree' will get an error. Spec defines 7 commands.\n\n**Fix:**\n1. Add variants to UpkeepCommand enum:\n```rust\n#[derive(Debug, Subcommand)]\npub enum UpkeepCommand {\n    Detect,\n    Audit,\n    Deps,\n    Quality,\n    Unused,\n    Unsafe,\n    Tree,\n}\n```\n\n2. Add match arms in src/cli/commands/mod.rs:\n```rust\nUpkeepCommand::Unsafe =\u003e {\n    tracing::warn!(\"unsafe command not yet implemented\");\n}\nUpkeepCommand::Tree =\u003e {\n    tracing::warn!(\"tree command not yet implemented\");\n}\n```\n\n**Files to modify:**\n- src/cli/mod.rs (add enum variants)\n- src/cli/commands/mod.rs (add match arms)\n\n**Acceptance:** cargo run -- upkeep unsafe and cargo run -- upkeep tree are recognized commands","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-04T07:32:05.680526-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.090745-06:00","closed_at":"2026-02-04T07:36:09.090745-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-j0d","title":"Remove module-level allow(dead_code) in output.rs","description":"In src/core/output.rs line 3, module-level #![allow(dead_code)] suppresses warnings for all types. This can hide genuinely unused code. Remove module-level allow and add targeted #[allow(dead_code)] only to specific types with comments explaining why.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:08.286388-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.794647-06:00","closed_at":"2026-02-04T21:15:15.794647-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-j1l8","title":"Add test for spawn_blocking JoinError in detect command","description":"In src/cli/commands/mod.rs:17-21, detect uses spawn_blocking but error path (panic/cancellation) has no test. Consider enriching error message to distinguish panic vs cancelled, and add test coverage.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T23:26:37.612301-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:13.076207-06:00","closed_at":"2026-02-04T23:31:13.076207-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-j1y","title":"Deps: display alias name for renamed deps","description":"Review follow-up: deps output currently uses package name (dep.name). For renamed deps in Cargo.toml, consider showing alias (dep.rename) or both so CLI matches manifest.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T10:04:42.959904-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T10:30:59.373412-06:00","closed_at":"2026-02-04T10:30:59.373412-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-j72","title":"Audit: add non-JSON vulnerability list","description":"Review feedback: non-JSON audit output only prints summary. Add a concise list/table of vulnerabilities with advisory_id, package, version, severity.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T12:24:01.345232-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:26:20.308601-06:00","closed_at":"2026-02-04T12:26:20.308601-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-jztu","title":"Apply map_join_error pattern to deps fetch_security","description":"In deps.rs:413-417, JoinError maps to generic TaskFailed. Apply same map_audit_join_error pattern from audit.rs to distinguish panic vs cancellation.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:03:34.436133-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.587891-06:00","closed_at":"2026-02-05T13:07:58.587891-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-kgj0","title":"Add external tool helper unit tests","description":"Target: src/core/analyzers/external_tool.rs\n\nAdd unit tests for helper behavior:\n- is_missing_subcommand detects cargo subcommand missing patterns across tools.\n- is_unknown_flag detects unsupported flags with variant stderr formats.\n- handle_tool_output returns MissingTool and ExternalCommand with correct messages for failing status.\n- run_cargo_tool argument wiring (command + args + current_dir) via a small harness or by validating constructed Command when feasible.\n\nMock output/stderr to avoid invoking real tools.","acceptance_criteria":"- Tests cover detection helpers and error mapping.\n- handle_tool_output paths (success, missing tool, other failure) are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:54:02.911133-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:00:34.519235-06:00","closed_at":"2026-02-04T23:00:34.519235-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-kju","title":"Improve virtual root handling in tree.rs","description":"In src/cli/commands/tree.rs lines 112-113, when build_node returns None, a synthetic 'root' node with empty package_id is created. The logic works but is fragile. Make virtual root case more explicit with dedicated field or variant.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:17.195641-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.890837-06:00","closed_at":"2026-02-04T21:15:15.890837-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-l3c","title":"Add serde and serde_json dependencies","description":"Spec and CLAUDE.md list serde/serde_json as key dependencies but they're missing from Cargo.toml.\n\n**File:** Cargo.toml\n\n**Why it matters:** JSON output (--json flag) requires serialization. The output module has no implementation because these deps are missing.\n\n**Fix:**\nAdd to Cargo.toml:\n```toml\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\n```\n\nThen in output.rs, define serializable types:\n```rust\nuse serde::Serialize;\n\n#[derive(Debug, Serialize)]\npub struct UpkeepOutput\u003cT\u003e {\n    pub success: bool,\n    pub data: T,\n    #[serde(skip_serializing_if = \"Option::is_none\")]\n    pub error: Option\u003cString\u003e,\n}\n```\n\n**Acceptance:** cargo build includes serde, --json flag can serialize output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:05.976992-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:47.517157-06:00","closed_at":"2026-02-04T21:21:47.517157-06:00","close_reason":"DONE: serde and serde_json in Cargo.toml"}
{"id":"upkeep-rs-la1","title":"Audit: disambiguate dependency path key","description":"Review feedback: DependencyGraph path resolution keys packages by name+version only; include source or PackageId to avoid ambiguity with same version from different sources.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T12:24:01.238011-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:26:20.093274-06:00","closed_at":"2026-02-04T12:26:20.093274-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ldn","title":"Add module-level rustdoc documentation","description":"No rustdoc comments exist anywhere in the codebase.\n\n**Issue:** Zero documentation for public APIs\n\n**Why it matters:**\n- Contributors can't understand module purposes\n- cargo doc output is empty/useless\n- Future library consumers have no guidance\n- Code is harder to maintain without context\n\n**Fix:**\nAdd module-level docs to each file:\n\nsrc/cli/mod.rs:\n```rust\n//! CLI argument parsing and command dispatch for cargo-upkeep.\n//!\n//! This module handles:\n//! - Command-line argument parsing via clap\n//! - Global flags (--verbose, --json, --log-level)\n//! - Subcommand routing to handlers\n```\n\nsrc/core/mod.rs:\n```rust\n//! Core analysis and scoring logic for cargo-upkeep.\n//!\n//! This module contains the business logic separate from CLI concerns,\n//! enabling both CLI usage and potential library consumption.\n```\n\n**Files to modify:**\n- All .rs files in src/\n\n**Acceptance:** cargo doc generates useful documentation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:24.710431-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.33827-06:00","closed_at":"2026-02-04T07:45:42.33827-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-lg2","title":"Fix silent failure in logging initialization","description":"The .ok() call silently discards errors from tracing try_init().\n\n**Issue:** src/cli/mod.rs lines 60-64 - Error silently discarded\n\n**Current:**\n```rust\ntracing_subscriber::fmt()\n    .with_env_filter(filter)\n    .with_writer(std::io::stderr)\n    .try_init()\n    .ok();  // Error silently discarded\n```\n\n**Why it matters:** If tracing fails to initialize, user gets no indication. Could mask real configuration problems.\n\n**Fix - Option A (Document intentional):**\n```rust\n// Intentionally ignore error - may fail if already initialized (e.g., in tests)\ntracing_subscriber::fmt()\n    .with_env_filter(filter)\n    .with_writer(std::io::stderr)\n    .try_init()\n    .ok();\n```\n\n**Fix - Option B (Warn on failure):**\n```rust\nif let Err(e) = tracing_subscriber::fmt()\n    .with_env_filter(filter)\n    .with_writer(std::io::stderr)\n    .try_init()\n{\n    eprintln!(\"Warning: tracing initialization failed: {e}\");\n}\n```\n\n**Files to modify:**\n- src/cli/mod.rs\n\n**Acceptance:** Either documented why silent failure is OK, or warning printed on failure","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:32:11.179605-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.184897-06:00","closed_at":"2026-02-04T07:36:09.184897-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-lj3g","title":"Add tree stats integration test","description":"Tree tests verify node structure but not stats object (total_crates, direct_deps, transitive_deps, duplicate_crates). Add stats verification to tests/tree.rs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T10:22:55.772141-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:45:47.945878-06:00","closed_at":"2026-02-05T12:45:47.945878-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ljx","title":"Quality/Detect: move metadata calls off async","description":"Review feedback: check_msrv uses blocking cargo_metadata on async runtime and detect::run is sync inside async handler. Use spawn_blocking or async wrapper to avoid blocking Tokio core thread.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T21:28:00.868036-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:33:32.482976-06:00","closed_at":"2026-02-04T21:33:32.482976-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-llm","title":"Deps: add error context","description":"Review feedback: wrap MetadataCommand::exec and version parsing with context to make errors actionable.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.751304-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:27.135419-06:00","closed_at":"2026-02-04T21:21:27.135419-06:00","close_reason":"DONE: Error context added throughout deps.rs using UpkeepError::context()"}
{"id":"upkeep-rs-m3u","title":"Fix inconsistent workspace detection in deps.rs","description":"In src/cli/commands/deps.rs:70, workspace detection uses 'metadata.workspace_members.len() \u003e 1' but detect.rs uses 'root_package.is_none() || metadata.workspace_members.len() \u003e 1'. This means deps reports workspace:false for virtual workspace with single member. Align with detect's correct logic.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:37:05.711513-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.099322-06:00","closed_at":"2026-02-04T22:48:50.099322-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-md3","title":"Add unit tests for error detection functions","description":"In unsafe_code.rs and unused.rs, missing tests for: is_missing_geiger/machete, is_unknown_output_flag/json_flag, JSON parsing error paths, text fallback parsing. Add unit tests with known inputs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:45.028869-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.422379-06:00","closed_at":"2026-02-04T21:53:48.422379-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-mhj","title":"Fix stub commands to show visible output","description":"All command handlers use tracing::info! but default log level is warn, so users see nothing.\n\n**File:** src/cli/commands/mod.rs:9-29\n\n**Why it matters:** Running 'cargo upkeep detect' produces no output and exits 0. Users get silent success for a stub, which is confusing.\n\n**Fix - Option A (warn level):**\n```rust\nUpkeepCommand::Detect =\u003e {\n    tracing::warn!(\"detect: not yet implemented\");\n}\n```\n\n**Fix - Option B (stdout message):**\n```rust\nUpkeepCommand::Detect =\u003e {\n    println!(\"detect: not yet implemented\");\n}\n```\n\n**Fix - Option C (return error):**\n```rust\nUpkeepCommand::Detect =\u003e {\n    anyhow::bail!(\"detect command not yet implemented\");\n}\n```\n\nOption C is recommended - unimplemented commands should fail, not silently succeed.\n\n**Acceptance:** Running any stub command produces visible output or non-zero exit","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:43:50.982465-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:18:31.949048-06:00","closed_at":"2026-02-04T22:18:31.949048-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-mi2","title":"Wire up --json flag to command handlers","description":"The --json global flag is defined but never used in command handlers.\n\n**File:** src/cli/mod.rs:37-38\n\n**Why it matters:** Flag is documented in README and spec, but passing it has no effect. Violates principle of least surprise.\n\n**Fix:**\n1. Pass json flag through to command handlers:\n```rust\n// In commands/mod.rs\npub async fn handle(command: UpkeepCommand, json: bool) -\u003e Result\u003c()\u003e {\n    // Use json flag to control output format\n}\n```\n\n2. Update main.rs to pass the flag:\n```rust\ncli::commands::handle(upkeep.command, upkeep.json).await\n```\n\n3. In each command handler, use json to decide output format:\n```rust\nif json {\n    println!(\"{}\", serde_json::to_string(\u0026output)?);\n} else {\n    println!(\"{:?}\", output);\n}\n```\n\n**Acceptance:** --json flag affects command output format","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:43:50.549772-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:18:56.878247-06:00","closed_at":"2026-02-04T21:18:56.878247-06:00","close_reason":"Already implemented - json flag passed through main.rs to all command handlers"}
{"id":"upkeep-rs-mq2t","title":"Improve rate limiter error message with bug report guidance","description":"In crates_io.rs:77-83, error 'rate limiter semaphore closed unexpectedly' lacks guidance. Add '(this is a bug, please report it)' to indicate internal error.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:03:34.656953-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.649766-06:00","closed_at":"2026-02-05T13:07:58.649766-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-mrqk","title":"Add printer error propagation tests","description":"In audit.rs, unsafe_code.rs, unused.rs - run_with functions accept printer closures but no tests verify printer errors propagate correctly. Add tests that return Err from printers and verify it bubbles up.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:32:55.246146-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:37:03.512943-06:00","closed_at":"2026-02-05T09:37:03.512943-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-mvvt","title":"Add score calculation assertion to clippy test","description":"In src/core/analyzers/clippy.rs:163-178, parse_clippy_output_counts_and_details test doesn't verify score field. Score is (100 - warnings*2 - errors*10). Add: assert_eq\\!(output.score, 88.0) for 1 warning + 1 error case.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T23:26:37.499531-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:13.044954-06:00","closed_at":"2026-02-04T23:31:13.044954-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-nb65","title":"Make cli_without_args_shows_help assert exit status","description":"Target: tests/cli.rs\n\nStrengthen cli_without_args_shows_help: still allow stdout/stderr flexibility, but assert exit status is success or known clap help status (0/2). This avoids false positives if the binary crashes while printing \"Usage\".","acceptance_criteria":"- Test asserts exit status is acceptable.\n- Output check still accepts stdout or stderr.\n- cargo test passes.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T10:16:45.315708-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:17:31.992312-06:00","closed_at":"2026-02-05T10:17:31.992312-06:00","close_reason":"Closed","labels":["tests"]}
{"id":"upkeep-rs-ne7b","title":"Fix README JSON example format","description":"In README.md:101-113, deps output example shows wrong field names (kind vs update_type). Update to match actual output structure.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-05T13:49:21.409798-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.723892-06:00","closed_at":"2026-02-05T14:04:28.723892-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-ngw","title":"Verify rust-version MSRV 1.70 is accurate","description":"Cargo.toml declares rust-version = \"1.70\" but this may not be accurate.\n\n**Issue:** Line 6 sets MSRV to 1.70 (June 2023) without verification\n\n**Why it matters:**\n- Dependencies may require newer Rust versions\n- CI should test against declared MSRV\n- Users on older Rust will get confusing errors\n- Some dependencies (rustsec, crates-index) may have higher requirements\n\n**Fix:**\n1. Run cargo msrv to determine actual minimum version:\n   ```bash\n   cargo install cargo-msrv\n   cargo msrv find\n   ```\n\n2. Update Cargo.toml with accurate rust-version\n\n3. Add MSRV check to CI:\n   ```yaml\n   - name: Check MSRV\n     run: |\n       rustup install 1.70\n       cargo +1.70 check\n   ```\n\n**Files to modify:**\n- Cargo.toml (rust-version field)\n- .github/workflows/ci.yml (when created)\n\n**Acceptance:** cargo +\u003cmsrv\u003e check succeeds, CI validates MSRV","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:50.68135-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.391668-06:00","closed_at":"2026-02-04T07:45:42.391668-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-o9x","title":"Replace println! with tracing in command handlers","description":"Placeholder command implementations use println! directly instead of structured output.\n\n**Issue:** src/cli/commands/mod.rs lines 7-21 - Direct println! usage\n\n**Current:**\n```rust\nUpkeepCommand::Detect =\u003e {\n    println!(\"detect not implemented\");\n}\n```\n\n**Why it matters:**\n- Not compatible with --json flag when implemented\n- Inconsistent with tracing-based logging\n- Should return proper error for unimplemented commands\n- Mixes output formats (println vs tracing)\n\n**Fix:**\n```rust\nUpkeepCommand::Detect =\u003e {\n    tracing::warn!(\"detect command not yet implemented\");\n    anyhow::bail!(\"detect command not yet implemented\")\n}\n```\n\nOr use a proper NotImplemented error type.\n\n**Files to modify:**\n- src/cli/commands/mod.rs (all match arms)\n\n**Acceptance:** Commands use tracing for output and return proper errors","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:32:33.666532-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:36:09.294397-06:00","closed_at":"2026-02-04T07:36:09.294397-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-oiws","title":"Add more field assertions to detect human readable test","description":"In tests/detect.rs:35-59, detect_outputs_human_readable_summary only checks 3 fields. Add assertions for Edition, Version, MSRV, Features, Targets, Tooling, CI to catch Display regressions.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:32:55.58184-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:37:03.597141-06:00","closed_at":"2026-02-05T09:37:03.597141-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-p6l","title":"BUG: Handle DependencyKind::Unknown variant","description":"Match on dep.kind doesn't handle DependencyKind::Unknown which exists in cargo_metadata.\n\n**File:** src/cli/commands/deps.rs lines 72-76\n\n**Current code:**\n```rust\nlet dependency_type = match dep.kind {\n    DependencyKind::Normal =\u003e DependencyType::Normal,\n    DependencyKind::Development =\u003e DependencyType::Dev,\n    DependencyKind::Build =\u003e DependencyType::Build,\n};\n```\n\n**Why it matters:** cargo_metadata's DependencyKind enum is non-exhaustive and includes Unknown variant. Current code will fail to compile with 'non-exhaustive patterns' error.\n\n**Fix:**\n```rust\nlet dependency_type = match dep.kind {\n    DependencyKind::Normal =\u003e DependencyType::Normal,\n    DependencyKind::Development =\u003e DependencyType::Dev,\n    DependencyKind::Build =\u003e DependencyType::Build,\n    _ =\u003e DependencyType::Normal, // Treat unknown as normal\n};\n```\n\n**Acceptance:** Code compiles and handles unknown dependency kinds gracefully","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T11:42:44.12227-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:10:53.619791-06:00","closed_at":"2026-02-04T12:10:53.619791-06:00","close_reason":"Fixed all three P1 bugs: added catch-all for DependencyKind::Unknown, changed is_stable to return false on parse failure, and added error context to HTTP requests"}
{"id":"upkeep-rs-p7dv","title":"Add unsafe-code CLI command tests","description":"Target: src/cli/commands/unsafe_code.rs\n\nAdd unit/integration coverage for unsafe-code command handler:\n- Verify JSON output path when cargo-geiger is available (mock or seam).\n- Verify MissingTool error mapping when geiger is not installed (stderr pattern).\n- Verify non-JSON output path prints human-readable summary.\n\nIf required, add a test seam to inject a fake external_tool runner so the handler can be tested without invoking cargo-geiger.","acceptance_criteria":"- Tests cover success + missing tool paths.\n- Both JSON and text output paths are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:12:06.758915-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:26:02.404673-06:00","closed_at":"2026-02-05T09:26:02.404673-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-p7l","title":"Remove placeholder assert!(true) smoke tests","description":"Five modules have smoke tests that only contain assert!(true), generating clippy warnings.\n\n**Files:**\n- src/main.rs:24\n- src/core/mod.rs:11\n- src/core/analyzers/mod.rs:7\n- src/core/scorers/mod.rs:7\n- src/core/output.rs:7\n\n**Why it matters:** These tests provide zero value - they don't test anything and generate clippy warnings. They signal incomplete test coverage.\n\n**Fix:** Remove empty test modules entirely until there's actual code to test:\n```rust\n// Remove entirely:\n#[cfg(test)]\nmod tests {\n    #[test]\n    fn smoke() {\n        assert!(true);\n    }\n}\n```\n\nOr keep minimal placeholder without assertion:\n```rust\n#[cfg(test)]\nmod tests {\n    // Tests will be added when module has implementations\n}\n```\n\n**Acceptance:** cargo clippy shows no warnings about assert!(true)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:26:44.208984-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:48.184362-06:00","closed_at":"2026-02-04T21:21:48.184362-06:00","close_reason":"DUPLICATE: Same as upkeep-rs-0rt"}
{"id":"upkeep-rs-p8d","title":"Detect: normalize members output","description":"Review feedback: DetectOutput.members uses PackageId::repr (name version source). Normalize to package names for stable output consistent with other commands.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T22:15:53.611509-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:18:32.591899-06:00","closed_at":"2026-02-04T22:18:32.591899-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-phw","title":"Add comprehensive error handling with thiserror","description":"Create src/lib/error.rs for robust error handling:\n\n1. Define custom error types using thiserror:\n   #[derive(Error, Debug)]\n   pub enum UpkeepError {\n     #[error('Failed to parse Cargo.toml: {0}')]\n     CargoTomlParse(#[from] toml::de::Error),\n     \n     #[error('Crate not found on crates.io: {0}')]\n     CrateNotFound(String),\n     \n     #[error('Failed to fetch from crates.io: {0}')]\n     CratesIoFetch(#[from] reqwest::Error),\n     \n     #[error('RustSec database error: {0}')]\n     RustSecError(String),\n     \n     #[error('Clippy not installed')]\n     ClippyNotInstalled,\n     \n     #[error('Not a Cargo project')]\n     NotCargoProject,\n     \n     #[error('External tool error: {tool} - {message}')]\n     ExternalToolError { tool: String, message: String },\n   }\n\n2. Create Result type alias: pub type Result\u003cT\u003e = std::result::Result\u003cT, UpkeepError\u003e;\n\n3. Implement JSON serialization for errors:\n   ErrorOutput { error: String, error_type: String, suggestion: Option\u003cString\u003e }\n\n4. Add context helpers using anyhow for internal errors\n5. Graceful degradation: Continue when one analyzer fails\n\nAcceptance: All commands handle errors gracefully with JSON error output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:07:54.98335-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T19:20:45.683856-06:00","closed_at":"2026-02-04T19:20:45.683856-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-pji","title":"Fix redundant closures in deps.rs (Clippy)","description":"In src/cli/commands/deps.rs:97,106,156,157,181, closures like |source| source.to_string() can be replaced with method references. Run cargo clippy --fix or manually apply.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:45.795213-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.215268-06:00","closed_at":"2026-02-04T21:53:48.215268-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-pkhl","title":"Add missing command docs to README","description":"README missing docs for unused and unsafe-code commands. Add sections describing these commands.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:49:21.527495-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.725273-06:00","closed_at":"2026-02-05T14:04:28.725273-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-prh","title":"Deps: workspace and target-specific handling","description":"Review feedback: deps analysis only uses root package and counts deps that might be target-specific/optional; workspace members are ignored. Clarify behavior: aggregate workspace members and/or add skipped counts for target-specific deps.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.544865-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.657786-06:00","closed_at":"2026-02-05T12:58:20.657786-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-pt4q","title":"Add unused CLI command tests","description":"Target: src/cli/commands/unused.rs\n\nAdd unit/integration coverage for unused command handler:\n- Verify JSON output path when cargo-machete is available (mock or seam).\n- Verify MissingTool error mapping when machete is not installed (stderr pattern).\n- Verify fallback to text parsing when JSON flag unsupported.\n- Verify non-JSON output path prints human-readable summary.\n\nIntroduce a small test seam to inject output for the command handler so tests do not depend on cargo-machete.","acceptance_criteria":"- Tests cover success, missing tool, and fallback parsing paths.\n- JSON and text output paths are asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:12:06.754221-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:26:02.519549-06:00","closed_at":"2026-02-05T09:26:02.519549-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-q5n","title":"Fix test printing to stdout in output.rs","description":"In src/core/output.rs:559-569, output_module_smoke() calls print_json() which prints to stdout during test. Either capture output or test serialization without printing.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T21:40:46.177515-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.245026-06:00","closed_at":"2026-02-04T21:53:48.245026-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-qj4","title":"Remove or populate empty module files","description":"Multiple empty module files exist as dead code.\n\n**Issue:** Empty files that add noise:\n- src/cli/commands/mod.rs - empty\n- src/lib/analyzers/mod.rs - empty\n- src/lib/scorers/mod.rs - empty\n- src/lib/output.rs - empty\n\n**Why it matters:**\n- Empty modules are dead code\n- Confuses contributors about what's implemented\n- Makes code navigation harder\n- cargo doc shows empty modules\n\n**Fix options:**\n1. Remove empty modules until needed, OR\n2. Add todo!() macros with doc comments:\n\n```rust\n//! Dependency analysis and outdated package detection.\n//!\n//! This module will contain:\n//! - crates.io version fetching\n//! - Cargo.lock parsing\n//! - Semver comparison\n\npub fn analyze_deps() {\n    todo!(\"Implement dependency analysis\")\n}\n```\n\n**Files to modify:**\n- src/cli/commands/mod.rs\n- src/lib/analyzers/mod.rs\n- src/lib/scorers/mod.rs\n- src/lib/output.rs\n\n**Acceptance:** No empty module files, all modules have purpose documented","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:23:24.364699-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:45:42.226315-06:00","closed_at":"2026-02-04T07:45:42.226315-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-qov","title":"BUG: Type mismatch in test - invert: false should be invert: None","description":"In src/cli/commands/mod.rs line 49, the test uses invert: false but TreeArgs.invert is defined as Option\u003cString\u003e.\n\n```rust\n// Current (buggy):\nUpkeepCommand::Tree(crate::cli::TreeArgs {\n    depth: Some(0),\n    duplicates: false,\n    invert: false,  // BUG: should be `invert: None`\n    features: false,\n    no_dev: false,\n}),\n```\n\nImpact: This will fail to compile. \n\nFix: Change `invert: false` to `invert: None`.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T18:37:31.266142-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:44:41.171498-06:00","closed_at":"2026-02-04T18:44:41.171498-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-qy0","title":"Add unit tests for handle_tool_output and parse_machete_text","description":"Missing tests: 1) external_tool.rs handle_tool_output() - success case, missing tool, non-zero with stdout, no stdout/stderr. 2) unused.rs parse_machete_text() - various machete output formats. 3) unsafe_code.rs summarize() overflow edge case.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:27:26.506221-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:05:50.03799-06:00","closed_at":"2026-02-04T23:05:50.03799-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-rbsp","title":"Document cargo-machete/geiger requirement for full test coverage","description":"Tests silently skip when cargo-machete/cargo-geiger not installed. Document in CLAUDE.md that these tools should be installed for full test coverage.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-05T09:32:55.694673-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:21.199717-06:00","closed_at":"2026-02-05T12:58:21.199717-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-rdu","title":"Add audit analyzer unit tests","description":"Target: src/core/analyzers/audit.rs\n\nAdd unit tests for:\n- map_severity mappings (Critical/High/Medium/Low/None/None -\u003e Low/Unknown -\u003e High).\n- summarize counts and total across mixed severities.\n- DependencyGraph::path_to: exact match with source, fallback without source, and missing path returns None.\n\nUse a minimal Metadata/Resolve fixture with 2-3 packages to exercise BFS path reconstruction.","acceptance_criteria":"- New tests compile and pass via cargo test.\n- Path_to tests cover source match + fallback + no-path.\n- Summary test covers all severities and total count.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:32:13.687396-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:01:27.695719-06:00","closed_at":"2026-02-04T23:01:27.695719-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-rty","title":"Make confidence configurable in unused.rs","description":"In src/core/analyzers/unused.rs:257,274,353, confidence is hardcoded to \"high\". Extract from JSON when available, use \"medium\" for text parsing since it's less reliable.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:18.733603-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.304526-06:00","closed_at":"2026-02-04T21:53:48.304526-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-rxv","title":"Add missing fields to DetectOutput Display impl","description":"The Display implementation for DetectOutput is incomplete - missing features, targets, tooling, ci fields.\n\n**File:** src/core/output.rs lines 133-156\n\n**Issue:** When users run without --json, they don't see features, targets, tooling, or ci information that IS shown in JSON output.\n\n**Why it matters:** Information asymmetry between JSON and human output confuses users.\n\n**Fix:**\nAdd the missing fields:\n```rust\nif !self.features.is_empty() {\n    writeln!(f, \"Features: {}\", self.features.join(\", \"))?;\n}\nif !self.targets.is_empty() {\n    writeln!(f, \"Targets: {}\", self.targets.join(\", \"))?;\n}\nif !self.tooling.is_empty() {\n    writeln!(f, \"Tooling: {}\", self.tooling.join(\", \"))?;\n}\nif !self.ci.is_empty() {\n    writeln!(f, \"CI: {}\", self.ci.join(\", \"))?;\n}\n```\n\n**Acceptance:** Human output shows all fields that JSON output shows","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T09:00:21.383628-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:10:38.282934-06:00","closed_at":"2026-02-04T09:10:38.282937-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ry5","title":"Refactor deps.rs analyze() - too long (196 lines)","description":"In src/cli/commands/deps.rs:22-236, analyze() is 196 lines, well above 100-line limit. Extract helpers: resolve_current_versions(), fetch_and_compare_versions(), collect_skipped_dependencies().","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:31.670886-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.335225-06:00","closed_at":"2026-02-04T21:53:48.335225-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-s4a","title":"Use \u0026Path instead of \u0026PathBuf in unsafe_code.rs","description":"In src/core/analyzers/unsafe_code.rs lines 51, 83, 111, three functions take \u0026PathBuf instead of \u0026Path. This is an anti-pattern: \u0026Path is more general and accepts both Path and PathBuf via deref coercion. Functions: run_geiger_json, run_geiger_json_alt, run_geiger.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T19:23:54.365337-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.568617-06:00","closed_at":"2026-02-04T21:15:15.568617-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-s4p","title":"Create upkeep-deps Claude Code skill","description":"Create skills/upkeep-deps/SKILL.md for Claude Code integration:\n\n1. Skill metadata:\n   # /upkeep-deps - Rust Dependency Updater\n   Trigger: User asks to update dependencies or check outdated crates\n\n2. Workflow:\n   - Run cargo upkeep deps to get outdated list\n   - Assess risk based on semver (major vs minor vs patch)\n   - For each update:\n     - Create feature branch\n     - Update version in Cargo.toml\n     - Run cargo build to check compilation\n     - Run cargo test to verify functionality\n     - If success: commit changes\n     - If failure: rollback and report issue\n\n3. Safety rules:\n   - Never update multiple major versions at once\n   - Always run tests before committing\n   - Create separate commits per dependency\n   - Warn about breaking changes\n\n4. Git workflow (per spec):\n   - Work in branches\n   - Create PRs via gh\n   - No Claude attribution\n\nReference TS: skills/upkeep-deps/ in upkeep repo\n\nAcceptance: Skill file complete with full workflow and examples","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T07:08:30.833436-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:51.557463-06:00","closed_at":"2026-02-05T13:28:51.557463-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-s4vr","title":"Promote machete runner seam to production helper","description":"Target: src/core/analyzers/unused.rs\n\nCurrently tests reimplement run_machete_json_with in test module. Promote a reusable helper in production (e.g., run_machete_json_with runner injection) and have tests call the real helper to avoid drift. Keep behavior unchanged; minimize refactor.","acceptance_criteria":"- Production helper accepts injected runner.\n- Tests use the production helper (no duplicate logic).\n- cargo test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-05T10:07:06.00303-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T10:13:27.985183-06:00","closed_at":"2026-02-05T10:13:27.985183-06:00","close_reason":"Closed","labels":["refactor","tests"]}
{"id":"upkeep-rs-sc5","title":"Add lib.rs to compile module tree","description":"Wire module tree by declaring \u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cp\u003e\u003cem\u003eError:\u003c/em\u003e Your request has found no candidate provider [hs=\"(null)\", id=\"(null)\"]\u003c/p\u003e\u003c/body\u003e\u003c/html\u003e and \u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cp\u003e\u003cem\u003eError:\u003c/em\u003e Your request has found no candidate provider [hs=\"(null)\", id=\"(null)\"]\u003c/p\u003e\u003c/body\u003e\u003c/html\u003e in src/main.rs so placeholder modules compile. Suppress the special_module_name lint for the lib module.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:14:56.546093-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:16:36.375378-06:00","closed_at":"2026-02-04T07:16:36.375378-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-sce","title":"BUG: is_stable should return false on parse failure","description":"When Version::parse fails, is_stable() returns true (stable), which is backwards.\n\n**File:** src/core/analyzers/crates_io.rs lines 160-165\n\n**Current code:**\n```rust\nfn is_stable(version: \u0026str) -\u003e bool {\n    match Version::parse(version) {\n        Ok(parsed) =\u003e parsed.pre.is_empty(),\n        Err(_) =\u003e true,  // Bug: treating unparseable as stable\n    }\n}\n```\n\n**Why it matters:** If crates.io returns malformed version string, code incorrectly treats it as stable. Could recommend upgrading to broken/invalid version.\n\n**Fix:**\n```rust\nfn is_stable(version: \u0026str) -\u003e bool {\n    match Version::parse(version) {\n        Ok(parsed) =\u003e parsed.pre.is_empty(),\n        Err(_) =\u003e false,  // Conservative: don't recommend unparseable versions\n    }\n}\n```\n\n**Acceptance:** Unparseable versions are treated as unstable","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T11:42:44.739936-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:10:53.651136-06:00","closed_at":"2026-02-04T12:10:53.651136-06:00","close_reason":"Fixed all three P1 bugs: added catch-all for DependencyKind::Unknown, changed is_stable to return false on parse failure, and added error context to HTTP requests"}
{"id":"upkeep-rs-sf7d","title":"Add cli command handler unit tests","description":"Target: src/cli/commands/*.rs\n\nAdd unit tests for command handlers (audit/deps/quality/unused/unsafe/tree/detect):\n- Verify JSON output shape for each command using minimal fixtures or mocked analyzer outputs.\n- Verify errors are surfaced via UpkeepError with expected ErrorCode.\n- For quality: ensure recommendation generation and grade mapping are output.\n\nIf needed, add lightweight test seams to inject analyzer results without running external tools.","acceptance_criteria":"- Tests cover each command handler output path (success + error).\n- JSON output assertions for each command.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:54:02.905369-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.212945-06:00","closed_at":"2026-02-05T12:58:20.212945-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-suo","title":"Extract shared error handling in unused.rs","description":"In src/core/analyzers/unused.rs lines 32-90, run_machete_json and run_machete_plain have nearly identical error handling. Extract common logic into a shared helper to reduce duplication.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:23:55.147485-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.730383-06:00","closed_at":"2026-02-04T21:15:15.730383-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-telc","title":"Verify and fix binstall bin-dir in Cargo.toml","description":"In Cargo.toml:39,45,47, verify binstall metadata syntax is correct and bin-dir path matches release archive structure.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:49:21.651124-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T14:04:28.726634-06:00","closed_at":"2026-02-05T14:04:28.726634-06:00","close_reason":"Fixed in this session"}
{"id":"upkeep-rs-to3","title":"Simplify latest version tracking logic in fetch_from_index","description":"The 'latest' variable is only updated inside 'if allow_prerelease' block but the logic works because it falls back correctly. Code is confusing.\n\n**File:** src/core/analyzers/crates_io.rs lines 99-112\n\n**Issue:** When allow_prerelease is false, 'latest' is never updated, but this is masked because line 119 returns latest_stable for the latest field anyway.\n\n**Fix:** Either always track latest, or add comment explaining the intentional behavior:\n```rust\n// Always track the actual latest version\nif latest.as_ref().map_or(true, |current| parsed \u003e *current) {\n    latest = Some(parsed.clone());\n}\n```\n\n**Acceptance:** Code logic is clear and correct","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T11:42:55.996072-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:23.711779-06:00","closed_at":"2026-02-04T21:21:23.711779-06:00","close_reason":"OBSOLETE: Code uses fetch_from_api not fetch_from_index, logic is already simple"}
{"id":"upkeep-rs-trt","title":"Implement CLI framework with clap derive macros","description":"Implemented clap derive CLI with global flags and support for both 'cargo upkeep' and 'cargo-upkeep' invocation; added unsafe-code/tree commands and logging init.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T07:06:06.776298-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T08:55:59.531897-06:00","closed_at":"2026-02-04T08:55:59.498956-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-u05","title":"Remove module-level allow(dead_code) from clippy.rs and quality.rs","description":"Both src/core/analyzers/clippy.rs:1 and src/core/scorers/quality.rs:1 have #![allow(dead_code)]. Review if code is actually used; if so remove allow, if not add targeted allows with comments.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:37:07.12516-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:48:50.190627-06:00","closed_at":"2026-02-04T22:48:50.190627-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-u5hr","title":"Move sleep/Duration import inside test function","description":"In src/cli/commands/audit.rs:50, tokio::time::{sleep, Duration} import is at test module level but only used in one test. Move inside the specific test that uses it.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T09:32:55.129506-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T09:37:03.479657-06:00","closed_at":"2026-02-05T09:37:03.479657-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-u60","title":"Add test for virtual workspace detection","description":"Tests don't cover virtual workspaces (no root package).\n\n**File:** tests/detect.rs\n\n**Current coverage:**\n1. Single package (non-workspace) - workspace: false\n2. Multi-member workspace - workspace: true\n\n**Missing:** Virtual workspace with single member\n\n**Why it matters:** Virtual workspaces are common (serde, tokio use them). Current bug is masked because multi-member test uses 2 members.\n\n**Fix:**\n```rust\n#[test]\nfn detect_outputs_workspace_true_for_virtual_workspace() {\n    let temp_dir = tempfile::tempdir().expect(\"temp dir\");\n    let root = temp_dir.path();\n\n    fs::create_dir_all(root.join(\"crates\").join(\"single-crate\").join(\"src\"))\n        .expect(\"create single-crate\");\n\n    // Virtual workspace - no [package], only [workspace]\n    fs::write(\n        root.join(\"Cargo.toml\"),\n        \"[workspace]\\nmembers = [\\\"crates/single-crate\\\"]\\n\",\n    ).expect(\"write workspace Cargo.toml\");\n\n    // ... create single-crate with Cargo.toml and src/lib.rs ...\n\n    let json: Value = serde_json::from_str(\u0026output).expect(\"parse json\");\n    assert_eq!(json[\"workspace\"], true);  // Must be true for virtual workspace\n}\n```\n\n**Acceptance:** Virtual workspace test exists and passes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:14:42.933933-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T09:16:37.81793-06:00","closed_at":"2026-02-04T09:16:37.817933-06:00"}
{"id":"upkeep-rs-uhe","title":"Deps: clarify optional deps not activated","description":"Review follow-up: optional deps that are not activated can fall into MissingResolve. Consider adding a SkipReason for optional-not-activated or detect dep.optional and report accordingly.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T10:04:43.069622-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T10:30:59.602321-06:00","closed_at":"2026-02-04T10:30:59.602321-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-uhp","title":"Add installation instructions to README","description":"README shows usage but doesn't explain how to install.\n\n**File:** README.md\n\n**Why it matters:** Users need to know how to get the tool before they can use it.\n\n**Fix:**\nAdd installation section:\n```markdown\n## Installation\n\n### From source (requires Rust 1.70+)\n\n\\`\\`\\`bash\ngit clone https://github.com/llbbl/cargo-upkeep\ncd cargo-upkeep\ncargo install --path .\n\\`\\`\\`\n\n### From crates.io (once published)\n\n\\`\\`\\`bash\ncargo install cargo-upkeep\n\\`\\`\\`\n\n### Using cargo-binstall (once published)\n\n\\`\\`\\`bash\ncargo binstall cargo-upkeep\n\\`\\`\\`\n```\n\n**Acceptance:** README has installation section with multiple methods","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:55.825595-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:58:20.43685-06:00","closed_at":"2026-02-05T12:58:20.43685-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-up0","title":"Deps: consider optional vs target-specific skip precedence","description":"Review feedback: for optional deps with target-specific qualifiers, skip reason currently prioritizes TargetSpecific. Consider prioritizing OptionalNotActivated or reporting combined causes in deps output.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-04T10:33:42.747526-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T12:22:59.130271-06:00","closed_at":"2026-02-04T12:22:59.130271-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-usb","title":"Extract shared ExternalToolRunner for geiger/machete","description":"In unsafe_code.rs:53-121 and unused.rs:34-102, the run_*_json, handle_*_output, run_*, is_missing_*, missing_*_error, is_unknown_*_flag functions are nearly identical. Extract a generic ExternalToolRunner utility module.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T21:40:17.988006-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:53:48.275221-06:00","closed_at":"2026-02-04T21:53:48.275221-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-uudw","title":"Clarify deps --security lockfile requirement","description":"Target: README.md\n\nNote that deps --security requires Cargo.lock; suggest generating it with cargo generate-lockfile if missing.","acceptance_criteria":"- README mentions Cargo.lock requirement.\n- Includes suggested command to generate lockfile.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-05T13:28:15.643002-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:28:52.310529-06:00","closed_at":"2026-02-05T13:28:52.310529-06:00","close_reason":"Closed","labels":["docs"]}
{"id":"upkeep-rs-v5pq","title":"Add core error handling tests","description":"Target: src/core/error.rs\n\nAdd unit tests for UpkeepError construction and formatting:\n- ErrorCode serialization or display output (if implemented).\n- UpkeepError::message and ::context preserve code and message.\n- Nested source error formatting includes context message.\n- JSON error output (if serialized via core/output) matches expected shape with code/message/context.\n\nUse simple dummy source errors to verify chaining behavior.","acceptance_criteria":"- Tests cover message/context constructors and error formatting.\n- JSON error output (if applicable) is asserted.\n- cargo test passes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T22:53:15.715047-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:04:40.975879-06:00","closed_at":"2026-02-04T23:04:40.975879-06:00","close_reason":"Closed","labels":["coverage","tests"]}
{"id":"upkeep-rs-vkq","title":"Update clap version from 4.0 to 4.5","description":"Cargo.toml specifies clap 4.0 which is outdated.\n\n**Issue:** Cargo.toml line 11 has clap = { version = \"4.0\", features = [\"derive\"] }\n\n**Why it matters:**\n- clap 4.4+ has important bug fixes\n- Better derive macro ergonomics in newer versions\n- Security patches may be missing\n- Missing features available in newer versions\n\n**Fix:**\nUpdate Cargo.toml:\n```toml\nclap = { version = \"4.5\", features = [\"derive\"] }\n```\n\nThen run:\n```bash\ncargo update -p clap\n```\n\n**Files to modify:**\n- Cargo.toml (line 11)\n\n**Acceptance:** clap version is 4.5+, cargo build succeeds","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T07:22:57.377979-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T07:28:50.986-06:00","closed_at":"2026-02-04T07:28:50.986-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-w4y","title":"BUG: Conflicting HTTP client features between crates-index and rustsec","description":"The build fails due to mutually exclusive features between crates-index (with git-https) and rustsec. Both crates transitively depend on gix-transport, but they enable conflicting HTTP client features (http-client-reqwest vs http-client-curl).\n\nFix options:\n1. Use default-features = false on one or both crates and explicitly enable compatible features\n2. Check if rustsec has a feature flag to control its HTTP client\n3. Consider using sparse index instead of git for crates-index\n\nExample fix:\n```toml\ncrates-index = { version = \"2.0\", default-features = false, features = [\"sparse\"] }\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T12:30:31.86455-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T14:08:34.965268-06:00","closed_at":"2026-02-04T14:08:34.965268-06:00","close_reason":"Fixed: removed crates-index (using direct API), added fallback source matching in path_to, improved JoinError handling"}
{"id":"upkeep-rs-we5","title":"Rename print_error_json for clarity","description":"In src/core/error.rs lines 108-117, print_error_json writes to stderr via eprintln\\!, but 'print_' typically implies stdout. Rename to eprint_error_json or print_error_json_to_stderr, or document the behavior clearly.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T19:24:16.92664-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:15:15.857803-06:00","closed_at":"2026-02-04T21:15:15.857803-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-wj1","title":"Add tests for logging initialization error handling","description":"The init_logging function has no test coverage.\n\n**File:** src/cli/mod.rs:54-73\n\n**Why it matters:** Function can fail (invalid log level), error handling should be verified.\n\n**Fix:**\nAdd tests for filter creation logic:\n```rust\n#[cfg(test)]\nmod tests {\n    use tracing_subscriber::EnvFilter;\n\n    #[test]\n    fn valid_log_levels_parse() {\n        assert!(EnvFilter::try_new(\"trace\").is_ok());\n        assert!(EnvFilter::try_new(\"debug\").is_ok());\n        assert!(EnvFilter::try_new(\"info\").is_ok());\n        assert!(EnvFilter::try_new(\"warn\").is_ok());\n        assert!(EnvFilter::try_new(\"error\").is_ok());\n    }\n\n    #[test]\n    fn invalid_log_level_fails() {\n        // This should fail - invalid level\n        let filter = EnvFilter::try_new(\"invalid_xyz\");\n        assert!(filter.is_err());\n    }\n}\n```\n\nNote: Full init_logging test is tricky since subscriber can only initialize once per process.\n\n**Acceptance:** Log level parsing has test coverage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:34.426359-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:06:26.905448-06:00","closed_at":"2026-02-04T23:06:26.905448-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-wos","title":"BUG: Missing #[allow(dead_code)] for serde deserialization structs","description":"In clippy.rs lines 9-32, the CargoMessage, DiagnosticMessage, DiagnosticCode, and DiagnosticSpan structs have fields that rustc reports as 'never read', but they ARE read by serde during deserialization.\n\nThis generates 4+ warnings on every build.\n\nFix: Add #![allow(dead_code)] at the top of the file (already present) or add #[allow(dead_code)] to each struct.\n\nActually, checking the file - it already has #![allow(dead_code)] so this may not be an issue. Verify by running cargo clippy.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T17:45:22.419191-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T17:52:23.44723-06:00","closed_at":"2026-02-04T17:52:23.44723-06:00","close_reason":"Fixed: conditional synthetic error, added allow(dead_code), standardized score calculation with saturating_sub, use total_cmp for float sorting"}
{"id":"upkeep-rs-xuf","title":"BUG: DependencyType needs Copy derive for unused parser loop","description":"In src/core/analyzers/unused.rs, DependencyType is used with fallback_type passed by value multiple times in parse_dependency_array, but it does not implement Copy.\n\n```rust\nfn parse_dependency_array(items: \u0026[Value], fallback_type: DependencyType) -\u003e Result\u003cVec\u003cUnusedDep\u003e\u003e {\n    for item in items {\n        // ...\n        dependency_type: fallback_type,  // moved each iteration - will fail on second item\n    }\n}\n```\n\nImpact: Code will fail to compile when parsing multiple dependencies of the same type in an array. The first iteration moves fallback_type, subsequent iterations fail.\n\nFix: Add Copy and Clone derives to DependencyType in src/core/output.rs:\n```rust\n#[derive(Debug, Serialize, Clone, Copy)]\npub enum DependencyType {\n    Normal,\n    Dev,\n    Build,\n}\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T18:37:32.188989-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:44:41.202451-06:00","closed_at":"2026-02-04T18:44:41.202451-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-y8t3","title":"Move run_with_output tests to run_with.rs module","description":"Tests for run_with_output (JSON/text printer, error propagation) are duplicated in audit.rs, unused.rs, unsafe_code.rs. Move to run_with.rs where function is defined. Command modules should only test command-specific logic.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T10:22:55.665517-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:45:47.914068-06:00","closed_at":"2026-02-05T12:45:47.914068-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-ys7","title":"BUG: cargo machete runs without explicit working directory","description":"In src/core/analyzers/unused.rs lines 68-77, cargo machete is run without explicitly setting the working directory:\n\n```rust\nasync fn run_machete(args: \u0026[\u0026str]) -\u003e Result\u003cstd::process::Output\u003e {\n    Command::new(\"cargo\")\n        .args(args)\n        // Missing: .current_dir(project_dir)\n        .output()\n        .await\n}\n```\n\nImpact: If a user runs `cargo upkeep unused` from a different directory than the project, or if the tool is invoked by another tool/IDE, it may analyze the wrong project or fail.\n\nNote: This is consistent with other commands that use cargo_metadata without explicit working dir. Could be deferred if we document that the tool must be run from project root.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T18:37:34.026674-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T18:44:41.260312-06:00","closed_at":"2026-02-04T18:44:41.260312-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-z48y","title":"Add HTTP error path tests for crates_io.rs","description":"In src/core/analyzers/crates_io.rs:171-282, tests cover happy paths but not HTTP errors. Add tests for: 404 responses, network errors, JSON parse errors. Use httpmock to return error status codes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-04T23:26:44.704792-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T23:31:12.954722-06:00","closed_at":"2026-02-04T23:31:12.954722-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-z50r","title":"Make machete fallback test less brittle","description":"In src/core/analyzers/unused.rs:453-500, test asserts exact arg array order. Should verify semantics (first has --json, second doesn't) not exact ordering.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T10:22:55.984016-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T12:45:48.006393-06:00","closed_at":"2026-02-05T12:45:48.006393-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-zi6","title":"Fix blocking Command in clippy.rs async context","description":"In src/core/analyzers/clippy.rs:37-51, uses std::process::Command instead of tokio::process::Command, blocking async runtime. Either use tokio Command, wrap in spawn_blocking, or document blocking context requirement.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-04T22:27:26.067293-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:33:21.335946-06:00","closed_at":"2026-02-04T22:33:21.335946-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-zom","title":"Add help text descriptions to CLI subcommands","description":"UpkeepCommand enum variants have no documentation or help text.\n\n**File:** src/cli/mod.rs:44-52\n\n**Why it matters:** Running 'cargo upkeep --help' shows subcommands but with no descriptions. Makes CLI harder to use.\n\n**Fix:**\nAdd doc comments which clap uses as help text:\n```rust\n#[derive(Debug, Subcommand)]\npub enum UpkeepCommand {\n    /// Detect project configuration (edition, features, workspace)\n    Detect,\n    /// Check for security vulnerabilities (RustSec advisory database)\n    Audit,\n    /// Check for outdated dependencies with semver classification\n    Deps,\n    /// Generate A-F health grade for the project\n    Quality,\n    /// Find unused dependencies\n    Unused,\n    /// Report unsafe code usage\n    #[command(name = \"unsafe\")]\n    Unsafe,\n    /// Enhanced dependency tree visualization\n    Tree,\n}\n```\n\n**Acceptance:** cargo run -- upkeep --help shows descriptions for each subcommand","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T08:44:06.407294-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T22:18:31.72956-06:00","closed_at":"2026-02-04T22:18:31.72956-06:00","close_reason":"Closed"}
{"id":"upkeep-rs-zr3","title":"Deps: improve non-JSON output details","description":"Review feedback: DepsOutput display only prints summary counts. Add list/table of outdated packages with current/latest/required/dependency_type.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T09:56:01.645391-06:00","created_by":"loganlindquist","updated_at":"2026-02-04T21:21:36.840548-06:00","closed_at":"2026-02-04T21:21:36.840548-06:00","close_reason":"DONE: fmt::Display for DepsOutput provides detailed human-readable output"}
{"id":"upkeep-rs-zu7g","title":"Unify emit helper patterns across commands","description":"detect.rs, quality.rs, tree.rs define local emit_output_with functions duplicating run_with::run_with_output logic. Refactor to use shared helper or extract synchronous variant.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-05T13:03:34.322635-06:00","created_by":"loganlindquist","updated_at":"2026-02-05T13:07:58.558588-06:00","closed_at":"2026-02-05T13:07:58.558588-06:00","close_reason":"Closed"}
